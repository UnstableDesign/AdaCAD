<div class="filebrowser">

  <mat-form-field class="filename">
    <mat-label>Current Workspace</mat-label>
    <div><input matInput [(ngModel)]="files.current_file_name" placeholder="Filename" (change)="rename()"> </div>
  </mat-form-field>


  <div>
    <button 
    mat-button   
    [matMenuTriggerFor]="clearScreen" color="primary">
      <i class="fa-regular fa-plus"></i> New Workspace</button>
  </div>

  <mat-menu #clearScreen mat-raised-button>
    <a  (click)="onNewWorkspace()" mat-menu-item> Opening a new workspace will clear the current workspace. Are you sure you want to do this?</a>
  </mat-menu>

  <div> 
    <button 
    (click)="openNewFileDialog()"
    mat-button 
    color="primary"><i class="fa-regular fa-folder-open"></i> Open Workspace From Your Computer</button>
  </div>


  <div> 
    <button 
    mat-button 
    [matMenuTriggerFor]="downloadDropdown"
    color="primary"><i class="fa-solid fa-download"></i> Download to Your Computer
  </button>

  <mat-menu #downloadDropdown mat-raised-button>
    <a  (click)="saveAsAda()" mat-menu-item> as AdaCAD workspace file</a>
    <a  (click)="saveAsBmp()" mat-menu-item> export all visible drafts as bitmaps</a>
    <!-- <a  (click)="saveAsWif()" mat-menu-item> export all visible drafts as .WIF files</a> -->
  </mat-menu>


  </div>




  <mat-divider></mat-divider>



<div *ngIf="!auth.isLoggedIn">
  <button mat-raised-button matTooltip="login" (click) = "openLoginDialog()"><i class="fa fa-sign-in"></i> Log in</button> to load and save files online
</div>


<mat-list *ngIf="auth.isLoggedIn">
  <h2> Saved on AdaCAD</h2>

  <!-- <div class="auth" *ngIf="(auth.showLogoutButton)">
    Hi {{auth.username}} <a mat-icon-button matTooltip="logout" (click)="logout()"><i class="fa fa-sign-out"></i></a>
  </div> -->






    <!-- <mat-list-item>
      <mat-icon mat-list-icon><i class="fa-solid fa-folder"></i></mat-icon>
       <div mat-line class="folder_name">folder name    
        <button mat-button [matMenuTriggerFor]="folderopts">  <i class="fa-solid fa-ellipsis"></i></button>
      
       </div>

       <mat-menu #folderopts="matMenu">
        <button mat-menu-item>
          <span>Rename</span>
        </button>
        <button mat-menu-item>
          <span>Delete</span>
        </button>

      </mat-menu>
    </mat-list-item> -->


      <!-- files-->
        <ng-container *ngIf="filelist !== undefined">
        <mat-list-item  *ngFor="let file of filelist">
          <ng-container *ngIf="file !== null && file.meta !== null">


            <div class="file-item-block">
              <div class="fav"> 
                <button 
                mat-icon-button 
                matListItemIcon
                (click)="toggleFavorite(file.id)"
                *ngIf="file.id !== this.files.current_file_id">
                  <i *ngIf="ws.isFavorite(file.id)" class="fa-solid fa-star"></i>
                  <i *ngIf="!ws.isFavorite(file.id)" class="fa-regular fa-star"></i>
               </button>
                <button 
                *ngIf="file.id === this.files.current_file_id" 
                mat-icon-button 
                matListItemIcon>
                  <i class="fa-solid fa-eye"></i>
                </button></div>
              <div class="details">
                <button 
                mat-button 
                matListItemTitle 
                [class.accent]="file.id == this.files.current_file_id" 
                class="file_name">
                {{file.id}} || {{file.meta.name}} 
              </button>
                <div matListItemTitle class="timestamp">{{file.meta.date}} </div>
              </div>
              <div class="more">  <button mat-icon-button [matMenuTriggerFor]="fileopts">  <i class="fa-solid fa-ellipsis"></i></button></div>
       


 
                <mat-menu #fileopts="matMenu">
                <!-- <button mat-menu-item>
                  <span>Rename</span>
                </button>
                <button mat-menu-item>
                  <span>Download</span>
                </button> -->
                <button 
                mat-menu-item
                (click) = "remove(file.id)"
                >
                  <span>Delete</span>
                </button>
        
              </mat-menu>
              </div>
       </ng-container>
      </mat-list-item>
    </ng-container>
     
     

      <!-- <div mat-line>filder name | <i class="fa-solid fa-folder"></i><i class="fa-solid fa-folder"></i></div> -->
  

    <!-- <mat-list-item *ngFor="let folder of folders">
      <mat-icon mat-list-icon>folder</mat-icon>
      <div mat-line>{{folder.name}}</div>
      <div mat-line> {{folder.updated | date}} </div>
    </mat-list-item> -->

</mat-list>


</div>