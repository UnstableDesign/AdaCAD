
<h2 *ngIf="data.selectOnly" mat-dialog-title>Load File From AdaCAD</h2>
<h2 *ngIf="!data.selectOnly" mat-dialog-title>Manage Files</h2>

<mat-dialog-content class="filebrowser">



      <!-- files-->
        <div *ngIf="!auth.isLoggedIn">
          <button mat-flat-button  color="primary" matTooltip="login" (click) = "openLoginDialog()"><i class="fa fa-sign-in"></i> Log in</button> to load and save files online
        </div>
      


      <ng-container *ngIf="!files.connected">
        Saved files cannot be accessed because you are offline.
      </ng-container>

        <ng-container *ngIf="filelist !== undefined && auth.isLoggedIn && files.connected">

        <div  *ngFor="let file of filelist">
          <ng-container *ngIf="file !== null && file.meta !== null">


            <div class="file-item-block" [class.current]="file.id === this.files.current_file_id">
           
              <div class="details">

    
                <div  *ngIf="file.id == this.files.current_file_id && rename_mode">
                <mat-form-field class="example-full-width" class="filename">
                  <mat-label>Rename File</mat-label>
                  <div><input matInput color="accent" [(ngModel)]="files.current_file_name" placeholder="Filename" (change)="rename()"> </div>
                </mat-form-field>

                <mat-form-field class="example-full-width" >
                  <mat-label>Description</mat-label>
                  <textarea matInput placeholder="Ex. this file creates..."  [(ngModel)]="files.current_file_desc"></textarea>
                </mat-form-field>
                <button 
                mat-raised-button
                color="accent"
                (click) = "rename()">

        
                 Save
               
                </button>
               
              </div>

                <ng-container *ngIf="data.selectOnly">

                  <button *ngIf="(file.id == this.files.current_file_id && !rename_mode) || file.id !== this.files.current_file_id" 
                  mat-button 
                  [class.primary]="file.id == this.files.current_file_id" 
                  (click) = openFile(file.id)
                  class="file_name">

                  {{file.meta.name}}
                
                  </button>
                </ng-container>

                <ng-container *ngIf="!data.selectOnly">

                  <span *ngIf="(file.id == this.files.current_file_id && !rename_mode) || file.id !== this.files.current_file_id" 
                  mat-button        
                  class="file_name">

                  {{file.meta.name}}
                
                </span>
                </ng-container>

                <div *ngIf="file.id != this.files.current_file_id"  class="timestamp">last viewed on: {{file.meta.date}} </div>


                <div *ngIf="(file.id == this.files.current_file_id && !rename_mode)"  class="timestamp">last saved at: {{last_saved_time}} </div>


              </div>

              <div class="more" *ngIf="!data.selectOnly"> 

             

                <button 
                mat-icon-button 
                matListItemIcon
                matTooltip="rename this file"
                (click)="rename()"
                ><i class="fas fa-edit"></i>
              </button>


              <button 
              mat-icon-button 
              matListItemIcon
              matTooltip="open"
              (click)="openFile(file.id)"
              > <i class="fa-solid fa-book-open"></i>
            </button>


                <button 
                mat-icon-button 
                matListItemIcon
                matTooltip="Download the current AdaCAD file"
                [matMenuTriggerFor]="downloadDropdown"
                ><i class="fa-solid fa-download"></i>
                </button>

     
           
             <button 
             mat-icon-button 
             [matMenuTriggerFor]="deleteConfirm"
             >
             <i class="fa-solid fa-trash"></i>
              </button>

              <mat-menu #deleteConfirm>
                <button 
                mat-icon-button 
                matListItemIcon
                (click) = "remove(file.id)"
                >
                 Are you sure?
                 </button>
              </mat-menu>
            
              
              </div>
       


 
  
               
        
              </div>
       </ng-container>

       
      </div>
    </ng-container>

    <!-- <mat-divider></mat-divider> -->
    <!-- <h2>Publicly Shared Files</h2> -->

      
     
     

      <!-- <div mat-line>filder name | <i class="fa-solid fa-folder"></i><i class="fa-solid fa-folder"></i></div> -->
  

    <!-- <mat-list-item *ngFor="let folder of folders">
      <mat-icon mat-list-icon>folder</mat-icon>
      <div mat-line>{{folder.name}}</div>
      <div mat-line> {{folder.updated | date}} </div>
    </mat-list-item> -->



</mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button mat-dialog-close>Close</button>
</mat-dialog-actions>
