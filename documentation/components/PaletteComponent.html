<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>adacad-weaver documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	    <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">adacad-weaver documentation</a>
            <button type="button" class="btn btn-default btn-menu fa fa-bars" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <div id="book-search-input" role="search">
                <input type="text" placeholder="Type to search">
            </div>
            <nav>
            
                <ul class="list">
            
                    <li class="title">
                        <a href="../">adacad-weaver documentation</a>
                    </li>
            
                    <li class="divider"></li>
            
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../"><span class="fa fa-home"></span>Getting started</a>
                        <ul class="links">
                                <li class="link">
                                    <a href="../" ><span class="fa fa-file-text-o"></span>README</a>
                                </li>
                                <li class="link">
                                    <a 
                                        
                                         href="../overview.html" 
                                         href="../overview.html" 
                                        >
                                        <span class="fa fa-th"></span>Overview
                                    </a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="./modules.html" >
                            <span class="fa fa-archive"></span>
                            <span>Modules</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-modules-links"
                            ></span>
                        </a>
                        <ul class="links collapse in"
                                id="xs-modules-links"
                            >
                                <li class="link">
                                    <a href="../modules/AppModule.html" >AppModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/AppRoutingModule.html" >AppRoutingModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/CoreModule.html" >CoreModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/MixerModule.html" >MixerModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/WeaverModule.html" >WeaverModule</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-cogs"></span>
                            <span>Components</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-components-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-components-links"
                            >
                                <li class="link">
                                    <a href="../components/AboutModal.html" >AboutModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/AppComponent.html" >AppComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ConnectionComponent.html" >ConnectionComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ConnectionModal.html" >ConnectionModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/FlowComponent.html" >FlowComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/InitModal.html" >InitModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/LabelModal.html" >LabelModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/LoomComponent.html" >LoomComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MasksComponent.html" >MasksComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MaterialModal.html" >MaterialModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MaterialsComponent.html" >MaterialsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerComponent.html" >MixerComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerDesignComponent.html" >MixerDesignComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerPatternsComponent.html" >MixerPatternsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerViewComponent.html" >MixerViewComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/NotesComponent.html" >NotesComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/OperationComponent.html" >OperationComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/PaletteComponent.html"  class="active" >PaletteComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/PatternModal.html" >PatternModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/PatternsComponent.html" >PatternsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SchematicComponent.html" >SchematicComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ShuttlesModal.html" >ShuttlesModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SnackbarComponent.html" >SnackbarComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SubdraftComponent.html" >SubdraftComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SystemsComponent.html" >SystemsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/TopbarComponent.html" >TopbarComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/TreeComponent.html" >TreeComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/UploadFormComponent.html" >UploadFormComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverComponent.html" >WeaverComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverDesignComponent.html" >WeaverDesignComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverPatternsComponent.html" >WeaverPatternsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverViewComponent.html" >WeaverViewComponent</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-code"></span>
                            <span>Directives</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-directives-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-directives-links"
                            >
                                <li class="link">
                                    <a href="../directives/SelectionComponent.html" >SelectionComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../directives/WeaveDirective.html" >WeaveDirective</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-file-code-o"></span>
                            <span>Classes</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-classes-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-classes-links"
                            >
                                <li class="link">
                                    <a href="../classes/AdaCADWeaverPage.html" >AdaCADWeaverPage</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Cell.html" >Cell</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Connection.html" >Connection</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Draft.html" >Draft</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Loom.html" >Loom</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Pattern.html" >Pattern</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Point.html" >Point</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Render.html" >Render</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Selection.html" >Selection</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Shape.html" >Shape</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Shuttle.html" >Shuttle</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/System.html" >System</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Timeline.html" >Timeline</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Upload.html" >Upload</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Util.html" >Util</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../routes.html" ><span class="fa fa-code-fork"></span>Routes</a>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-long-arrow-down"></span>
                            <span>Injectables</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-injectables-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-injectables-links"
                            >
                                <li class="link">
                                    <a href="../injectables/DesignmodesService.html" >DesignmodesService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/InkService.html" >InkService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/LayersService.html" >LayersService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/OperationService.html" >OperationService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/PatternService.html" >PatternService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/TreeService.html" >TreeService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/UploadService.html" >UploadService</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-info"></span>
                            <span>Interfaces</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-interfaces-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-interfaces-links"
                            >
                                <li class="link">
                                    <a href="../interfaces/Bounds.html" >Bounds</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DensityUnits.html" >DensityUnits</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DesignActions.html" >DesignActions</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DesignActions.html" >DesignActions</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DesignMode.html" >DesignMode</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DesignModes.html" >DesignModes</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DraftInterface.html" >DraftInterface</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DraftMap.html" >DraftMap</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/HistoryState.html" >HistoryState</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Ink.html" >Ink</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Interlacement.html" >Interlacement</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/InterlacementVal.html" >InterlacementVal</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/LoomCoords.html" >LoomCoords</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/LoomTypes.html" >LoomTypes</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/LoomUpdate.html" >LoomUpdate</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/MaterialTypes.html" >MaterialTypes</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Node.html" >Node</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Operation.html" >Operation</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/OperationParams.html" >OperationParams</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Point.html" >Point</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/StartOptions.html" >StartOptions</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/TreeNode.html" >TreeNode</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/ViewModes.html" >ViewModes</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-plus"></span>
                            <span>Pipes</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-pipes-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-pipes-links"
                            >
                                <li class="link">
                                    <a href="../pipes/FilterPipe.html" >FilterPipe</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../miscellaneous.html" ><span class="fa fa-cubes"></span>Miscellaneous</a>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                    </li>
            
                    <li class="divider"></li>
                    <li class="copyright">
                            Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                        <img src="..//images/compodoc-vectorise.svg" class="img-responsive">
                            </a>
                    </li>
            
                </ul>
            
            </nav>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <nav>
                   
                       <ul class="list">
                   
                           <li class="title">
                               <a href="../">adacad-weaver documentation</a>
                           </li>
                   
                           <li class="divider"></li>
                   
                               <div id="book-search-input" role="search">
                                   <input type="text" placeholder="Type to search">
                               </div>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../"><span class="fa fa-home"></span>Getting started</a>
                               <ul class="links">
                                       <li class="link">
                                           <a href="../" ><span class="fa fa-file-text-o"></span>README</a>
                                       </li>
                                       <li class="link">
                                           <a 
                                               
                                                href="../overview.html" 
                                                href="../overview.html" 
                                               >
                                               <span class="fa fa-th"></span>Overview
                                           </a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="./modules.html" >
                                   <span class="fa fa-archive"></span>
                                   <span>Modules</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#modules-links"
                                   ></span>
                               </a>
                               <ul class="links collapse in"
                                       id="modules-links"
                   >
                                       <li class="link">
                                           <a href="../modules/AppModule.html" >AppModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/AppRoutingModule.html" >AppRoutingModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/CoreModule.html" >CoreModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/MixerModule.html" >MixerModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/WeaverModule.html" >WeaverModule</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-cogs"></span>
                                   <span>Components</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#components-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="components-links"
                   >
                                       <li class="link">
                                           <a href="../components/AboutModal.html" >AboutModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/AppComponent.html" >AppComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ConnectionComponent.html" >ConnectionComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ConnectionModal.html" >ConnectionModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/FlowComponent.html" >FlowComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/InitModal.html" >InitModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/LabelModal.html" >LabelModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/LoomComponent.html" >LoomComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MasksComponent.html" >MasksComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MaterialModal.html" >MaterialModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MaterialsComponent.html" >MaterialsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerComponent.html" >MixerComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerDesignComponent.html" >MixerDesignComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerPatternsComponent.html" >MixerPatternsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerViewComponent.html" >MixerViewComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/NotesComponent.html" >NotesComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/OperationComponent.html" >OperationComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/PaletteComponent.html"  class="active" >PaletteComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/PatternModal.html" >PatternModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/PatternsComponent.html" >PatternsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SchematicComponent.html" >SchematicComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ShuttlesModal.html" >ShuttlesModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SnackbarComponent.html" >SnackbarComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SubdraftComponent.html" >SubdraftComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SystemsComponent.html" >SystemsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/TopbarComponent.html" >TopbarComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/TreeComponent.html" >TreeComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/UploadFormComponent.html" >UploadFormComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverComponent.html" >WeaverComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverDesignComponent.html" >WeaverDesignComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverPatternsComponent.html" >WeaverPatternsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverViewComponent.html" >WeaverViewComponent</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-code"></span>
                                   <span>Directives</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#directives-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="directives-links"
                   >
                                       <li class="link">
                                           <a href="../directives/SelectionComponent.html" >SelectionComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../directives/WeaveDirective.html" >WeaveDirective</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-file-code-o"></span>
                                   <span>Classes</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#classes-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="classes-links"
                   >
                                       <li class="link">
                                           <a href="../classes/AdaCADWeaverPage.html" >AdaCADWeaverPage</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Cell.html" >Cell</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Connection.html" >Connection</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Draft.html" >Draft</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Loom.html" >Loom</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Pattern.html" >Pattern</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Point.html" >Point</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Render.html" >Render</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Selection.html" >Selection</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Shape.html" >Shape</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Shuttle.html" >Shuttle</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/System.html" >System</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Timeline.html" >Timeline</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Upload.html" >Upload</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Util.html" >Util</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../routes.html" ><span class="fa fa-code-fork"></span>Routes</a>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-long-arrow-down"></span>
                                   <span>Injectables</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#injectables-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="injectables-links"
                   >
                                       <li class="link">
                                           <a href="../injectables/DesignmodesService.html" >DesignmodesService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/InkService.html" >InkService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/LayersService.html" >LayersService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/OperationService.html" >OperationService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/PatternService.html" >PatternService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/TreeService.html" >TreeService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/UploadService.html" >UploadService</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-info"></span>
                                   <span>Interfaces</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#interfaces-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="interfaces-links"
                   >
                                       <li class="link">
                                           <a href="../interfaces/Bounds.html" >Bounds</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DensityUnits.html" >DensityUnits</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DesignActions.html" >DesignActions</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DesignActions.html" >DesignActions</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DesignMode.html" >DesignMode</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DesignModes.html" >DesignModes</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DraftInterface.html" >DraftInterface</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DraftMap.html" >DraftMap</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/HistoryState.html" >HistoryState</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Ink.html" >Ink</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Interlacement.html" >Interlacement</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/InterlacementVal.html" >InterlacementVal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/LoomCoords.html" >LoomCoords</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/LoomTypes.html" >LoomTypes</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/LoomUpdate.html" >LoomUpdate</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/MaterialTypes.html" >MaterialTypes</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Node.html" >Node</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Operation.html" >Operation</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/OperationParams.html" >OperationParams</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Point.html" >Point</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/StartOptions.html" >StartOptions</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/TreeNode.html" >TreeNode</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/ViewModes.html" >ViewModes</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-plus"></span>
                                   <span>Pipes</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#pipes-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="pipes-links"
                   >
                                       <li class="link">
                                           <a href="../pipes/FilterPipe.html" >FilterPipe</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../miscellaneous.html" ><span class="fa fa-cubes"></span>Miscellaneous</a>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                           </li>
                   
                           <li class="divider"></li>
                           <li class="copyright">
                                   Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                               <img src="..//images/compodoc-vectorise.svg" class="img-responsive">
                                   </a>
                           </li>
                   
                       </ul>
                   
                   </nav>
               </div>
               <div class="content component">
                   <div class="content-data">


<ol class="breadcrumb">
  <li>Components</li>
  <li>PaletteComponent</li>
</ol>


    <ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#infos" id="infos-tab" role="tab" data-toggle="tab">Infos</a>
        </li>
        <li>
            <a href="#source" role="tab" id="source-tab" data-toggle="tab">Source</a>
        </li>
    </ul>

    <div class="tab-content">
        <div class="tab-pane fade active in" id="infos"><p class="comment">
    <h3>File</h3>
</p>
<p class="comment">
    <code>src/app/mixer/palette/palette.component.ts</code>
</p>



<section>
    <h3>Metadata</h3>
    <table class="table table-sm table-hover">
        <tbody>












            <tr>
                <td class="col-md-3">selector</td>
                <td class="col-md-9"><code>app-palette</code></td>
            </tr>

            <tr>
                <td class="col-md-3">styleUrls</td>
                <td class="col-md-9"><code>palette.component.scss</code></td>
            </tr>



            <tr>
                <td class="col-md-3">templateUrl</td>
                <td class="col-md-9"><code>palette.component.html</code></td>
            </tr>


        </tbody>
    </table>
</section>

    <section>
        <h3 id="inputs">Inputs</h3>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-2">
                            <code>patterns</code>
                        </td>
                        <td class="col-md-10">
                            <div><p>a reference to the default patterns (used for fill operations)</p>
</div>
                              <p>
                                <em>Type:</em>    <code><a href="../classes/Pattern.html" target="_self" >Pattern[]</a></code>

                              </p>
                        </td>
                    </tr>
                </tbody>
            </table>
    </section>

    <section>
        <h3 id="outputs">Outputs</h3>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-2">
                            <code>onDesignModeChange</code>
                        </td>
                        <td class="col-md-10">
                            <em><code>$event</code> type:</em>    <code>any</code>

                        </td>
                    </tr>
                </tbody>
            </table>
    </section>

    <section>
        <h3 id="constructor">Constructor</h3>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <code>constructor(design_modes: <a href="../injectables/DesignmodesService.html" >DesignmodesService</a>, tree: <a href="../injectables/TreeService.html" >TreeService</a>, inks: <a href="../injectables/InkService.html" >InkService</a>, layers: <a href="../injectables/LayersService.html" >LayersService</a>, resolver: <a href="https://angular.io/docs/ts/latest/api/core/index/ComponentFactoryResolver-class.html" target="_blank" >ComponentFactoryResolver</a>, _snackBar: MatSnackBar)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Constructs a palette object. The palette supports drawing without components and dynamically<br>creates components from shapes and scribbles on the canvas. </p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>design_modes</b>
                                                    </div>
                                                    <div>
                                                        <p>a reference to the service containing the current design modes and selections</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>inks</b>
                                                    </div>
                                                    <div>
                                                        <p>a reference to the service manaing the available inks</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>layers</b>
                                                    </div>
                                                    <div>
                                                        <p>a reference to the sercie managing the view layers (z-indexes) of components</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>resolver</b>
                                                    </div>
                                                    <div>
                                                        <p>a reference to the factory component for dynamically generating components</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>_snackBar</b>
                                                    </div>
                                                    <div>
                                                        <p>_snackBar a reference to the snackbar component that shows data on move and select</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
    </section>

    <section>
        <h3 id="methods">Methods</h3>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> handleScroll</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>handleScroll(data: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> removeFromViewContainer</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>removeFromViewContainer(ref: <a href="https://angular.io/docs/ts/latest/api/core/index/ViewRef-class.html" target="_blank" >ViewRef</a>)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> addOperation</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>addOperation(name: string)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> rescale</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>rescale(scale: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> startSnackBar</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>startSnackBar(message: string, bounds: Bounds)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> updateSnackBar</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>updateSnackBar(message: string, bounds: Bounds)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> closeSnackBar</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>closeSnackBar()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> changeDesignmode</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>changeDesignmode(name: string)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> createSubDraft</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>createSubDraft(d: <a href="../classes/Draft.html" >Draft</a>)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>dynamically creates a subdraft component, adds its inputs and event listeners, pushes the subdraft to the list of references</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>d</b>
                                                    </div>
                                                    <div>
                                                        <p>a Draft object for this component to contain</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>SubdraftComponent</code>
    
                                </div>
                                    <div class="io-description">
                                        <p>the created subdraft instance</p>
    
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> createOperation</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>createOperation(name: string)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>creates an operation component</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>name</b>
                                                    </div>
                                                    <div>
                                                        <p>the name of the operation this component will perform</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>OperationComponent</code>
    
                                </div>
                                    <div class="io-description">
                                        <p>the OperationComponent created</p>
    
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> createConnection</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>createConnection(id_from: number, id_to: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>creates a connection component and registers it with the tree</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>number[]</code>
    
                                </div>
                                    <div class="io-description">
                                        <p>the list of all id&#39;s connected to the &quot;to&quot; node </p>
    
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> removeSubdraft</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>removeSubdraft(id: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>removes the subdraft sent to the function<br>updates the tree view_id&#39;s in response</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>id</b>
                                                    </div>
                                                    <div>
                                                        <p>* </p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> removeOperation</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>removeOperation(id: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>this function will</p>
    <ol>
    <li>delete the associated output subdraft</li>
    <li>recompue downsteam operations</li>
    <li>delete all input + output connections</li>
    </ol>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>id</b>
                                                    </div>
                                                    <div>
                                                        
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> createAndSetPreview</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>createAndSetPreview(d: <a href="../classes/Draft.html" >Draft</a>)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>dynamically creates a subdraft component with specific requirements of the intersection, adds its inputs and event listeners, pushes the subdraft to the list of references</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>d</b>
                                                    </div>
                                                    <div>
                                                        <p>a Draft object for this component to contain</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        <p>the created subdraft instance</p>
    
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> hasPreview</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>hasPreview()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>boolean</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> removePreview</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>removePreview()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>destorys the </p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>d</b>
                                                    </div>
                                                    <div>
                                                        <p>a Draft object for this component to contain</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        <p>the created subdraft instance</p>
    
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> designModeChanged</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>designModeChanged()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Called from mixer when it receives a change from the design mode tool or keyboard press<br>triggers view mode changes required for this mode</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> removeSubscription</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>removeSubscription()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawSelection</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawSelection(ndx: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> setCell</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>setCell(ndx: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>sets the value of the scratchpad cell at ndx<br>checks for self interselcting </p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>ndx</b>
                                                    </div>
                                                    <div>
                                                        <p>(i,j)</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> computeCellColor</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>computeCellColor(ink: string, over: <a href="../classes/Cell.html" >Cell</a>, under: boolean)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>called by drawcell. Draws on screen based on the current ink</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>ink</b>
                                                    </div>
                                                    <div>
                                                        
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>over</b>
                                                    </div>
                                                    <div>
                                                        
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>under</b>
                                                    </div>
                                                    <div>
                                                        
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>string</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> computeCellValue</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>computeCellValue(ink: string, over: <a href="../classes/Cell.html" >Cell</a>, under: boolean)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>applies the filter betetween over and under and returns the result</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>ink</b>
                                                    </div>
                                                    <div>
                                                        <p>the ink with which to compute the transition</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>over</b>
                                                    </div>
                                                    <div>
                                                        <p>the value of the primary (top) cell</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>under</b>
                                                    </div>
                                                    <div>
                                                        <p>the value of the intersecting (bottom) cell </p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>boolean</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> getScratchpadProduct</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>getScratchpadProduct(ndx: Interlacement, ink: string, over: <a href="../classes/Cell.html" >Cell</a>)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>called when creating a subdraft from the drawing on the screen. Computes the resulting value based on<br>all intersections with the drawing</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>ndx</b>
                                                    </div>
                                                    <div>
                                                        <p>the i,j location of the cell we are checking</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>ink</b>
                                                    </div>
                                                    <div>
                                                        <p>the currently selected ink</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>over</b>
                                                    </div>
                                                    <div>
                                                        <p>the Cell we are checking against</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>boolean</code>
    
                                </div>
                                    <div class="io-description">
                                        <p>true/false or null</p>
    
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawCell</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawCell(ndx: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>draw the cell at position ndx</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>ndx</b>
                                                    </div>
                                                    <div>
                                                        <p>(i,j)</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> onDeleteSubdraftCalled</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>onDeleteSubdraftCalled(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Deletes the subdraft that called this function.</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> onDuplicateSubdraftCalled</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>onDuplicateSubdraftCalled(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Deletes the subdraft that called this function.</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> subdraftStarted</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>subdraftStarted(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>A mouse event, originated in a subdraft, has been started<br>checkes the design mode and handles the event as required</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>obj</b>
                                                    </div>
                                                    <div>
                                                        <p>contains the id of the moving subdraft</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> selectInputDraft</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>selectInputDraft(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>triggers a mode that allows mouse-mouse to be followed by a line.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>obj</b>
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>contains event, id of component who called</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> setDraftsConnectable</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>setDraftsConnectable(op_id: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>adds a connector flag to any subdrafts that we are allowed to connect to from this operation</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> unsetDraftsConnectable</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>unsetDraftsConnectable()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>disables selection and pointer events on all</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> freezePaletteObjects</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>freezePaletteObjects()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>disables selection and pointer events on all</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> unfreezePaletteObjects</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>unfreezePaletteObjects()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>freezes all palette objects</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> connectionStarted</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>connectionStarted(topleft: <a href="../classes/Point.html" >Point</a>)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>called when a connection event starts</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> connectionDragged</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>connectionDragged(mouse: <a href="../classes/Point.html" >Point</a>, shift: boolean)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>draws when a user is using the mouse to identify an input to a component</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>mouse</b>
                                                    </div>
                                                    <div>
                                                        <p>the absolute position of the mouse on screen</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>shift</b>
                                                    </div>
                                                    <div>
                                                        <p>boolean representing if shift is pressed as well </p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> processConnectionEnd</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>processConnectionEnd()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>converts the shape on screen to a component</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> recalculateDownstreamDrafts</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>recalculateDownstreamDrafts(downstream_ops: number[])</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>given a node id, calculate any drafts that take place &quot;downstream&quot; from this draft</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>id</b>
                                                    </div>
                                                    <div>
                                                        
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> performOp</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>performOp(op_id: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> connectionMade</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>connectionMade(sd_id: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>emitted from subdraft when it receives a hit on its connection button, the id refers to the subdraft id</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> removeConnection</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>removeConnection(sd_id: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>emitted from subdraft when it receives a hit on its connection button but already<br>had something assigned there</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>id</b>
                                                    </div>
                                                    <div>
                                                        <p>the subdraft id that called the function</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> selectionStarted</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>selectionStarted()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> shapeStarted</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>shapeStarted(mouse: <a href="../classes/Point.html" >Point</a>)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>brings the base canvas to view and begins to render the</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>mouse</b>
                                                    </div>
                                                    <div>
                                                        <p>the absolute position of the mouse on screen</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> shapeDragged</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>shapeDragged(mouse: <a href="../classes/Point.html" >Point</a>, shift: boolean)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>resizes and redraws the shape between the the current mouse and where the shape started</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>mouse</b>
                                                    </div>
                                                    <div>
                                                        <p>the absolute position of the mouse on screen</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> processShapeEnd</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>processShapeEnd()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>converts the shape on screen to a component</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> drawStarted</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>drawStarted()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>clears the scratchpad for the new drawing event</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> getScratchPadBounds</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>getScratchPadBounds()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>gets the bounds of a drawing on the scratchpad, a drawing is represented by set cells</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>Interlacement[]</code>
    
                                </div>
                                    <div class="io-description">
                                        <p>an object representing the bounds in the format of i, j (the row, column index of the pad)</p>
    
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> processDrawingEnd</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>processDrawingEnd()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>handles checks and actions to take when drawing event ends<br>gets the boudary of drawn segment and creates a subdraft containing that drawing<br>if the drawing sits on top of an existing subdraft, merge the drawing into that subdraft (extending the original if neccessary)</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> onStart</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>onStart(event: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>handles actions to take when the mouse is down inside of the palette</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>event</b>
                                                    </div>
                                                    <div>
                                                        <p>the mousedown event</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> onMove</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>onMove(event: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> mouseSelectingDraft</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>mouseSelectingDraft(event: any, id: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>called when the operation input is selected and used to draw</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>event</b>
                                                    </div>
                                                    <div>
                                                        <p>the event object</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> onDrag</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>onDrag(event: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>called form the subscription created on start, checks the index of the location and returns null if its the same</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>event</b>
                                                    </div>
                                                    <div>
                                                        <p>the event object</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> onEnd</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>onEnd(event: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Called when the mouse is up or leaves the boundary of the view</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>event</b>
                                                    </div>
                                                    <div>
                                                        
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> processSelection</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>processSelection()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Called when a selection operation ends. Checks to see if this selection intersects with any subdrafts and<br>merges and or splits as required. </p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> updateAttachedComponents</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>updateAttachedComponents(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> onSubdraftAction</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>onSubdraftAction(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>emitted from a subdraft when an internal action has changeded its value<br>checks for a child subdraft, recomputes, redraws. </p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>obj</b>
                                                    </div>
                                                    <div>
                                                        <p>with attribute id describing the subdraft that called this</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> operationParamChanged</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>operationParamChanged(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>emitted from an operatioin when its param has changed<br>checks for a child subdraft, recomputes, redraws. </p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>obj</b>
                                                    </div>
                                                    <div>
                                                        <p>with attribute id describing the operation that called this</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> operationMoved</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>operationMoved(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>called from an operatiino cmoponent when it is dragged</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>obj</b>
                                                    </div>
                                                    <div>
                                                        <p>(id, point of toplleft)</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> subdraftMoved</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>subdraftMoved(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> subdraftDropped</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>subdraftDropped(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>checks if this subdraft has been dropped onto of another and merges them accordingly </p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>obj</b>
                                                    </div>
                                                    <div>
                                                        
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> mergeSubdrafts</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>mergeSubdrafts(primary: SubdraftComponent)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>merges a collection of subdraft components into the primary component, deletes the merged components</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>primary</b>
                                                    </div>
                                                    <div>
                                                        <p>the draft to merge into</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>boolean</code>
    
                                </div>
                                    <div class="io-description">
                                        <p>true or false to describe if a merge took place. </p>
    
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> computeHeddleValue</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>computeHeddleValue(p: <a href="../classes/Point.html" >Point</a>, main: SubdraftComponent, isect: SubdraftComponent[])</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>boolean</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> getSubdraftsIntersectingSelection</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>getSubdraftsIntersectingSelection(selection: <a href="../classes/Selection.html" >SelectionComponent</a>)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> getIntersectingSubdraftsForPoint</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>getIntersectingSubdraftsForPoint(p: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>get any subdrafts that intersect a given screen position</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>p</b>
                                                    </div>
                                                    <div>
                                                        <p>the x, y position of this cell </p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> getIntersectingSubdrafts</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>getIntersectingSubdrafts(primary: SubdraftComponent)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>get any subdrafts that intersect primary based on checks on their boundaries</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>primary</b>
                                                    </div>
                                                    <div>
                                                        
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> getSelectionBounds</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>getSelectionBounds(c1: any, c2: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>Bounds</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> getCombinedDraft</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>getCombinedDraft(bounds: Bounds, primary: SubdraftComponent, isect: SubdraftComponent[])</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>creates a draft in size bounds that contains all of the computed points of its intersections</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>bounds</b>
                                                    </div>
                                                    <div>
                                                        <p>the boundary of all the intersections</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>primary</b>
                                                    </div>
                                                    <div>
                                                        <p>the primary draft that we are checking for intersections</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>isect</b>
                                                    </div>
                                                    <div>
                                                        <p>an Array of the intersecting components</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code><a href="../classes/Draft.html" target="_self" >Draft</a></code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
    </section>

    <section>
        <h3 id="inputs">Properties</h3>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> canvas</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>canvas:     <code>HTMLCanvasElement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>HTML Canvas element that draws the selection and currently cells drawn on this component</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> canvas_zndx</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>canvas_zndx:     <code>number</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>links to the z-index to push the canvas to the front or back of view when freehand drawing. </p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> connection_op_id</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>connection_op_id:     <code>number</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> cx</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>cx:     <code>any</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> last</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>last:     <code>Interlacement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>stores an i and j of the last user selected location within the component</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> moveSubscription</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>moveSubscription:     <code>Subscription</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>Subscribes to move event after a touch event is started.</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> pointer_events</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>pointer_events:     <code>boolean</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>triggers a class to handle disabling pointerevents when switching modes</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> preview</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>preview:     <code>SubdraftComponent</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>a placeholder to reference a temporary rendering of an union between subdrafts<br>used to preview the changes that will happen if the subdraft is to be dropped at that point</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> preview_ref</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>preview_ref:     <code><a href="https://angular.io/docs/ts/latest/api/core/index/ViewRef-class.html" target="_blank" >ViewRef</a></code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>a reference to the viewref for the intersection component to ease addign and deleting</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> scale</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>scale:     <code>number</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>a value to represent the current user defined scale for this component. </p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> scratch_pad</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>scratch_pad:     <code><a href="../classes/Cell.html" target="_self" >Cell[][]</a></code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>holds the data of events drawn on this component (that are not associated with a subdraft)</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> selecting_connection</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>selecting_connection:     <code>boolean</code>
    </bcode>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                <i>Default value: </i><code>false</code>
                            </td>
                        </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> selection</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>selection:     <code><a href="../classes/Selection.html" target="_self" >SelectionComponent</a></code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>holds a reference to the selection component</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> shape_bounds</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>shape_bounds:     <code>Bounds</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>stores the bounds of the shape being drawn</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> shape_vtxs</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>shape_vtxs:     <code><a href="../classes/Point.html" target="_self" >Point[]</a></code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>stores the vtx for freehand shapes</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> snack_bounds</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>snack_bounds:     <code>Bounds</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> snack_message</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>snack_message:     <code>string</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>trackable inputs to snackbar</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> vc</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>vc:     <code><a href="https://angular.io/docs/ts/latest/api/core/index/ViewContainerRef-class.html" target="_blank" >ViewContainerRef</a></code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>A container that supports the automatic generation and removal of the components inside of it</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> viewport</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>viewport:     <code>Bounds</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>used to manage the area of the screen that is in view based on scrolling and zooming</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
    </section>
</div>
        <div class="tab-pane fade tab-source-code" id="source">
            <pre><code class="hljs javascript">import { Observable, Subscription, fromEvent, from, iif } from &#x27;rxjs&#x27;;
import { DesignmodesService } from &#x27;../../mixer/provider/designmodes.service&#x27;;
import { Component, HostListener, ViewContainerRef, Input, ComponentFactoryResolver, ViewChild, OnInit, ViewRef, Output, EventEmitter } from &#x27;@angular/core&#x27;;
import { SubdraftComponent } from &#x27;./subdraft/subdraft.component&#x27;;
import { SelectionComponent } from &#x27;./selection/selection.component&#x27;;
import { SnackbarComponent } from &#x27;./snackbar/snackbar.component&#x27;;
import { Draft } from &#x27;./../../core/model/draft&#x27;;
import { Cell } from &#x27;./../../core/model/cell&#x27;;
import {MatSnackBar} from &#x27;@angular/material/snack-bar&#x27;;
import { Point, Interlacement, Bounds, DraftMap } from &#x27;../../core/model/datatypes&#x27;;
import { Pattern } from &#x27;../../core/model/pattern&#x27;; 
import { InkService } from &#x27;../../mixer/provider/ink.service&#x27;;
import {cloneDeep, isBuffer} from &#x27;lodash&#x27;;
import { LayersService } from &#x27;../../mixer/provider/layers.service&#x27;;
import { Shape } from &#x27;../model/shape&#x27;;
import utilInstance from &#x27;../../core/model/util&#x27;;
import { OperationComponent } from &#x27;./operation/operation.component&#x27;;
import { ConnectionComponent } from &#x27;./connection/connection.component&#x27;;
import { TreeService } from &#x27;../provider/tree.service&#x27;;

@Component({
  selector: &#x27;app-palette&#x27;,
  templateUrl: &#x27;./palette.component.html&#x27;,
  styleUrls: [&#x27;./palette.component.scss&#x27;]
})


export class PaletteComponent implements OnInit{

  /**
   * a reference to the default patterns (used for fill operations)
   * @property {Array&lt;Pattern&gt;}
   */ 
  @Input() patterns: Array&lt;Pattern&gt;;
  @Output() onDesignModeChange: any &#x3D; new EventEmitter();

  /**
   * Subscribes to move event after a touch event is started.
   * @property {Subscription}
   */
  moveSubscription: Subscription;

  /**
   * A container that supports the automatic generation and removal of the components inside of it
   */
  @ViewChild(&#x27;vc&#x27;, {read: ViewContainerRef, static: true}) vc: ViewContainerRef;


  selecting_connection: boolean &#x3D; false;

  connection_op_id:number &#x3D; -1;

    /**
   * a placeholder to reference a temporary rendering of an union between subdrafts
   * used to preview the changes that will happen if the subdraft is to be dropped at that point
   * @property {SubdraftComponent}
   */
  preview: SubdraftComponent;

  /**
   * a reference to the viewref for the intersection component to ease addign and deleting
   * @property {ViewRef}
   */
  preview_ref: ViewRef;
     
  /**
   * holds a reference to the selection component
   * @property {Selection}
   */
  selection &#x3D; new SelectionComponent();

  /**
   * holds the data of events drawn on this component (that are not associated with a subdraft)
   * @property {Array&lt;Array&lt;Cell&gt;&gt;}
   */
  scratch_pad: Array&lt;Array&lt;Cell&gt;&gt; &#x3D; [];

  /**
   * HTML Canvas element that draws the selection and currently cells drawn on this component
   * @property {Canvas}
   */
  canvas: HTMLCanvasElement;
  cx: any;

  /**
   * stores an i and j of the last user selected location within the component
   * @property {Point}
   */
  last: Interlacement;

  /**
   * triggers a class to handle disabling pointerevents when switching modes
   * @property {boolean}
   */
   pointer_events: boolean;

  /**
   * a value to represent the current user defined scale for this component. 
   * @property {number}
   */

   scale: number;

  /**
   * links to the z-index to push the canvas to the front or back of view when freehand drawing. 
   */
   canvas_zndx:number &#x3D; -1;
  

  /**
   * used to manage the area of the screen that is in view based on scrolling and zooming
   */
   viewport:Bounds;
  
  /**
   * stores the bounds of the shape being drawn
   */
   shape_bounds:Bounds;
  
  /**
   * stores the vtx for freehand shapes
   */
   shape_vtxs:Array&lt;Point&gt;;
  

  /**
   * trackable inputs to snackbar
   */
   snack_message:string;
   snack_bounds: Bounds;
  

  /**
   * Constructs a palette object. The palette supports drawing without components and dynamically
   * creates components from shapes and scribbles on the canvas. 
   * @param design_modes  a reference to the service containing the current design modes and selections
   * @param inks a reference to the service manaing the available inks
   * @param layers a reference to the sercie managing the view layers (z-indexes) of components
   * @param resolver a reference to the factory component for dynamically generating components
   * @param _snackBar _snackBar a reference to the snackbar component that shows data on move and select
   */
  constructor(
    private design_modes: DesignmodesService, 
    private tree: TreeService,
    private inks: InkService, 
    private layers: LayersService, 
    private resolver: ComponentFactoryResolver, 
    private _snackBar: MatSnackBar) { 
    this.shape_vtxs &#x3D; [];
    this.viewport &#x3D; {
      topleft: {x:0, y:0}, 
      width: 0, 
      height:0
    };
    this.pointer_events &#x3D; true;
  }

/**
 * Called when palette is initailized
 */
  ngOnInit(){
    this.scale &#x3D; 5;
    this.vc.clear();
  }

  /**
   * unsubscribes to all open subscriptions and clears the view component
   */
  ngOnDestroy(){

    this.tree.getDrafts().forEach(element &#x3D;&gt; {
      element.onSubdraftStart.unsubscribe();
      element.onSubdraftDrop.unsubscribe();
      element.onSubdraftMove.unsubscribe();
      element.onDeleteCalled.unsubscribe();
      element.onDuplicateCalled.unsubscribe();
      element.onConnectionMade.unsubscribe();
      element.onConnectionRemoved.unsubscribe();
      element.onDesignAction.unsubscribe();
    });


    this.tree.getOperations().forEach(element &#x3D;&gt; {
      element.onSelectInputDraft.unsubscribe();
    });

    this.tree.getConnections().forEach(element &#x3D;&gt; {
    });
    this.vc.clear();
    
  }

  /**
   * Gets references to view items and adds to them after the view is initialized
   */
  ngAfterViewInit(){
    this.canvas &#x3D; &lt;HTMLCanvasElement&gt; document.getElementById(&quot;scratch&quot;);
    this.cx &#x3D; this.canvas.getContext(&quot;2d&quot;);
    this.canvas.width &#x3D; 5000;
    this.canvas.height &#x3D; 5000;

    this.selection.scale &#x3D; this.scale;
    this.selection.active &#x3D; false;
    this.designModeChanged();
  }

  handleScroll(data: any){
    const div:HTMLElement &#x3D; document.getElementById(&#x27;scrollable-container&#x27;);
    this.viewport.topleft &#x3D; {x: div.offsetParent.scrollLeft, y: div.offsetParent.scrollTop};
  }

  removeFromViewContainer(ref: ViewRef){
    const ndx: number &#x3D; this.vc.indexOf(ref);
    if(ndx !&#x3D; -1) this.vc.remove(ndx);
    else console.log(&#x27;Error: view ref not found for remvoal&#x27;);

  }


  addOperation(name:string){
    this.changeDesignmode(&#x27;operation&#x27;);
    const op:OperationComponent &#x3D; this.createOperation(name);
  }

  rescale(scale:number){
    this.scale &#x3D; scale;
    this.tree.getDrafts().forEach(sd &#x3D;&gt; {
      sd.rescale(scale);
    });

    this.tree.getOperations().forEach(sd &#x3D;&gt; {
      sd.rescale(scale);
    });

    this.tree.getConnections().forEach(sd &#x3D;&gt; {
      sd.rescale(scale);
    });

    if(this.preview !&#x3D;&#x3D; undefined) this.preview.scale &#x3D; this.scale;
  }

  

  startSnackBar(message: string, bounds:Bounds){
    this.updateSnackBar(message, bounds);
    this._snackBar.openFromComponent(SnackbarComponent, {
      data: {
        message: this.snack_message,
        bounds: this.snack_bounds,
        scale: this.scale
      }
    });
  }

  updateSnackBar(message: string, bounds:Bounds){
    this.snack_bounds &#x3D; bounds;
    this.snack_message &#x3D; message;
  }

  closeSnackBar(){
    this._snackBar.dismiss();
  }

  //called when the palette needs to change the design mode, emits output to parent
  changeDesignmode(name: string) {
    this.design_modes.select(name);
   
    const mode &#x3D; this.design_modes.getMode(name);
   
    if(!mode.enable_inks){
        this.inks.select(&#x27;neq&#x27;);
    }

    this.onDesignModeChange.emit(name);
  }

  // disablePointerEvents(){
  //   this.pointer_events &#x3D; false;
  // }

  // enablePointerEvents(){
  //   this.pointer_events &#x3D; true;
  // }

  /**
   * dynamically creates a subdraft component, adds its inputs and event listeners, pushes the subdraft to the list of references
   * @param d a Draft object for this component to contain
   * @returns the created subdraft instance
   */
  createSubDraft(d: Draft):SubdraftComponent{
    const factory &#x3D; this.resolver.resolveComponentFactory(SubdraftComponent);
    const subdraft &#x3D; this.vc.createComponent&lt;SubdraftComponent&gt;(factory);
    const id &#x3D; this.tree.createNode(&#x27;draft&#x27;, subdraft.instance, subdraft.hostView);

    subdraft.instance.onSubdraftDrop.subscribe(this.subdraftDropped.bind(this));
    subdraft.instance.onSubdraftMove.subscribe(this.subdraftMoved.bind(this));
    subdraft.instance.onSubdraftStart.subscribe(this.subdraftStarted.bind(this));
    subdraft.instance.onDeleteCalled.subscribe(this.onDeleteSubdraftCalled.bind(this));
    subdraft.instance.onDuplicateCalled.subscribe(this.onDuplicateSubdraftCalled.bind(this));
    subdraft.instance.onConnectionMade.subscribe(this.connectionMade.bind(this));
    subdraft.instance.onConnectionRemoved.subscribe(this.removeConnection.bind(this));
    subdraft.instance.onDesignAction.subscribe(this.onSubdraftAction.bind(this));
    subdraft.instance.draft &#x3D; d;
    subdraft.instance.id &#x3D; id;
    subdraft.instance.viewport &#x3D; this.viewport;
    subdraft.instance.patterns &#x3D; this.patterns;
    subdraft.instance.ink &#x3D; this.inks.getSelected(); //default to the currently selected ink
    subdraft.instance.scale &#x3D; this.scale;
    return subdraft.instance;
  }


  /**
   * creates an operation component
   * @param name the name of the operation this component will perform
   * @returns the OperationComponent created
   */
    createOperation(name: string):OperationComponent{
      const factory &#x3D; this.resolver.resolveComponentFactory(OperationComponent);
      const op &#x3D; this.vc.createComponent&lt;OperationComponent&gt;(factory);
      const id &#x3D; this.tree.createNode(&#x27;op&#x27;, op.instance, op.hostView);

      op.instance.onSelectInputDraft.subscribe(this.selectInputDraft.bind(this));
      op.instance.onOperationMove.subscribe(this.operationMoved.bind(this));
      op.instance.onOperationParamChange.subscribe(this.operationParamChanged.bind(this));
      op.instance.name &#x3D; name;
      op.instance.id &#x3D; id;
      op.instance.zndx &#x3D; this.layers.createLayer();
      op.instance.viewport &#x3D; this.viewport;
      op.instance.scale &#x3D; this.scale;
      return op.instance;
    }


    /**
     * creates a connection component and registers it with the tree
     * @returns the list of all id&#x27;s connected to the &quot;to&quot; node 
     */
     createConnection(id_from: number, id_to:number):Array&lt;number&gt;{
      console.log(&quot;TREE&quot;, this.tree.tree);
      console.log(&quot;from/to&quot;, id_from, id_to);

      const factory &#x3D; this.resolver.resolveComponentFactory(ConnectionComponent);
      const cxn &#x3D; this.vc.createComponent&lt;ConnectionComponent&gt;(factory);
      const id &#x3D; this.tree.createNode(&#x27;cxn&#x27;, cxn.instance, cxn.hostView);
      const to_input_ids: Array&lt;number&gt; &#x3D;  this.tree.addConnection(id_from, id_to, id);
      
      cxn.instance.id &#x3D; id;
      cxn.instance.scale &#x3D; this.scale;
      cxn.instance.from &#x3D; id_from;
      cxn.instance.to &#x3D; id_to;


      to_input_ids.forEach((el, ndx) &#x3D;&gt; {
        const sd: SubdraftComponent &#x3D; &lt;SubdraftComponent&gt; this.tree.getComponent(el);
        sd.active_connection_order &#x3D; ndx+1;
      });

      return to_input_ids;
    }


  /**
   * removes the subdraft sent to the function
   * updates the tree view_id&#x27;s in response
   * @param id {number}  
   * @todo delete any attached connections and 

   */
  removeSubdraft(id: number){

    const parent_id &#x3D; this.tree.getSubdraftParent(id);

    //removoe the node but get alll the ops before it is removed 
    const ref:ViewRef &#x3D; this.tree.getViewRef(id);
    const downstream_ops:Array&lt;number&gt; &#x3D; this.tree.getDownstreamOperations(id);
    this.tree.removeNode(id);

    const old_cxns:Array&lt;number&gt; &#x3D; this.tree.getUnusuedConnections();
    old_cxns.forEach(cxn &#x3D;&gt; {
      const cxn_view_ref &#x3D; this.tree.getViewRef(cxn);
      this.removeFromViewContainer(cxn_view_ref);
      this.tree.removeNode(cxn);
    });    


    // const ds: Array&lt;number&gt; &#x3D; this.tree.getDownstreamOperations(obj.id);
    // ds.forEach(op &#x3D;&gt; {
    //   this.performOp(op);
    // });
    //calls manually here so that the affected branches can be pinged before the node is deleted 
    this.recalculateDownstreamDrafts(downstream_ops);
    this.removeFromViewContainer(ref);

    //if it has a parent, recursively call on its parent
    if(parent_id !&#x3D; -1){
      this.removeSubdraft(parent_id);
    }

  }

  /**
   * this function will
   * 1. delete the associated output subdraft
   * 2. recompue downsteam operations
   * 3. delete all input + output connections
   * @param id 
   */
  removeOperation(id:number){

  }

    /**
   * dynamically creates a subdraft component with specific requirements of the intersection, adds its inputs and event listeners, pushes the subdraft to the list of references
   * @param d a Draft object for this component to contain
   * @returns the created subdraft instance
   */
    createAndSetPreview(d: Draft){
      const factory &#x3D; this.resolver.resolveComponentFactory(SubdraftComponent);
      const subdraft &#x3D; this.vc.createComponent&lt;SubdraftComponent&gt;(factory);
      //note, the preview is not added to the tree, as it will only be added if it eventually accepted by droppings
      subdraft.instance.draft &#x3D; d;
      subdraft.instance.id &#x3D; -1;
      subdraft.instance.setAsPreview();
      subdraft.instance.disableDrag();
      this.preview_ref &#x3D; subdraft.hostView;
      this.preview &#x3D; subdraft.instance;
      this.preview.scale &#x3D; this.scale;
    }

    hasPreview():boolean{
      if(this.preview_ref &#x3D;&#x3D;&#x3D; undefined) return false;
      return true;
    }

  /**
   * destorys the 
   * @param d a Draft object for this component to contain
   * @returns the created subdraft instance
   */
    removePreview(){
      const ndx &#x3D; this.vc.indexOf(this.preview_ref);
      this.vc.remove(ndx);
      this.preview_ref &#x3D; undefined;
      this.preview &#x3D; undefined;
  }

  /**
   * Called from mixer when it receives a change from the design mode tool or keyboard press
   * triggers view mode changes required for this mode
   */
  public designModeChanged(){

    if(this.design_modes.isSelected(&#x27;move&#x27;)){
      this.unfreezePaletteObjects();

    }else{
      this.freezePaletteObjects();
    }

    // if(this.design_modes.isSelected(&#x27;operation&#x27;)){
    //   this.disablePointerEvents();
    // }else{
    //   this.enablePointerEvents();
    // }


  }


   private removeSubscription() {    
    if (this.moveSubscription) {
      this.moveSubscription.unsubscribe();
    }
  }


  private drawSelection(ndx: Interlacement){


    this.cx.clearRect(0, 0, this.canvas.width, this.canvas.height);

    const bounds &#x3D;{
      top: this.selection.start.j*this.scale,
      left: this.selection.start.i*this.scale,
      bottom: ndx.j *this.scale,
      right: ndx.i*this.scale
    };

    //will draw on outside of selection
    this.cx.beginPath();
    this.cx.strokeStyle &#x3D; &quot;#ff4081&quot;;
    this.cx.lineWidth &#x3D; 1;
    this.cx.setLineDash([this.scale, 2]);
    this.cx.strokeRect(bounds.top, bounds.left, bounds.bottom-bounds.top, bounds.right-bounds.left);
      
  }

  /**
   * sets the value of the scratchpad cell at ndx
   * checks for self interselcting 
   * @param ndx (i,j)
   */
  private setCell(ndx: Interlacement){
    const c: Cell &#x3D; this.scratch_pad[ndx.i][ndx.j];
    if(this.inks.getSelected() &#x3D;&#x3D;&#x3D; &quot;down&quot;) c.setHeddle(false);
    else c.setHeddle(true);
    //use the code below to use past scratchpad values, but this seems wrong
    // console.log(c);
    // const val: boolean &#x3D; c.isSet(); //check for a previous value
    // c.setHeddle(true);

    // if(val){
    //   const newval:boolean &#x3D; this.computeCellValue(this.inks.getSelected(), c, val);
    //   console.log(&quot;setting to&quot;, newval);
    //   c.setHeddle(newval);
    // } 
  }

  /**
   * called by drawcell. Draws on screen based on the current ink
   * @param ink 
   * @param over 
   * @param under 
   * @returns 
   */
  private computeCellColor(ink: string, over: Cell, under: boolean): string{

    const res: boolean &#x3D; this.computeCellValue(ink, over, under);
    if(ink &#x3D;&#x3D;&#x3D; &#x27;unset&#x27; &amp;&amp; res &#x3D;&#x3D; true) return &quot;#cccccc&quot;; 
    if(res &#x3D;&#x3D;&#x3D;null) return &quot;#fafafa&quot;;
    if(res) return &quot;#000000&quot;;
    return &quot;#ffffff&quot;;      
  }

  /**
   * applies the filter betetween over and under and returns the result
   * @param ink the ink with which to compute the transition
   * @param over the value of the primary (top) cell
   * @param under the value of the intersecting (bottom) cell 
   * @returns 
   */
  private computeCellValue(ink: string, over: Cell, under: boolean): boolean{
    
    let res: boolean &#x3D; utilInstance.computeFilter(ink, over.getHeddle(), under);
    return res;   
  }

  /**
   * called when creating a subdraft from the drawing on the screen. Computes the resulting value based on
   * all intersections with the drawing
   * @param ndx the i,j location of the cell we are checking
   * @param ink the currently selected ink
   * @param over the Cell we are checking against
   * @returns true/false or null
   */
  private getScratchpadProduct(ndx: Interlacement, ink: string, over: Cell): boolean{
    
    switch(ink){
      case &#x27;neq&#x27;:
      case &#x27;and&#x27;:
      case &#x27;or&#x27;:

        const p &#x3D; {x: ndx.j * this.scale, y: ndx.i * this.scale};
        const isect &#x3D; this.getIntersectingSubdraftsForPoint(p);
  
        if(isect.length &gt; 0){
          const prev: boolean &#x3D; isect[0].resolveToValue(p);
          return this.computeCellValue(ink, over, prev);
        }else{
          return this.computeCellValue(ink, over, null);
        }
      break;

      default: 
        return this.computeCellValue(ink, over, null);
      break;
    }
   return null; 
  }
 

  /**
   * draw the cell at position ndx
   * @param ndx (i,j)
   */
  private drawCell(ndx: Interlacement){

    const c: Cell &#x3D; this.scratch_pad[ndx.i][ndx.j];
    this.cx.fillStyle &#x3D; &quot;#cccccc&quot;;
  
    const selected_ink:string &#x3D; this.inks.getSelected();

    switch(selected_ink){
      case &#x27;neq&#x27;:
      case &#x27;and&#x27;:
      case &#x27;or&#x27;:

        const p &#x3D; {x: ndx.j * this.scale, y: ndx.i * this.scale};
        const isect &#x3D; this.getIntersectingSubdraftsForPoint(p);

        if(isect.length &gt; 0){
          const prev: boolean &#x3D; isect[0].resolveToValue(p);
          this.cx.fillStyle &#x3D; this.computeCellColor(selected_ink, c, prev);
        }else{
          this.cx.fillStyle &#x3D;  this.computeCellColor(selected_ink, c, null);;
        }
      break;

      default: 
        this.cx.fillStyle &#x3D; this.computeCellColor(selected_ink, c, null);
      break;

    }

      this.cx.fillRect(ndx.j*this.scale, ndx.i*this.scale, this.scale, this.scale);      
  }

  /**
   * Deletes the subdraft that called this function.
   */
    onDeleteSubdraftCalled(obj: any){
      
      console.log(&quot;deleting &quot;+obj.id);
      if(obj &#x3D;&#x3D;&#x3D; null) return;
      this.removeSubdraft(obj.id);
   }

     /**
   * Deletes the subdraft that called this function.
   */
    onDuplicateSubdraftCalled(obj: any){
        console.log(&quot;duplicating &quot;+obj.id);
        if(obj &#x3D;&#x3D;&#x3D; null) return;
        const sd &#x3D; &lt;SubdraftComponent&gt; this.tree.getComponent(obj.id);
        const new_sd:SubdraftComponent &#x3D; this.createSubDraft(new Draft({wefts: sd.draft.wefts, warps: sd.draft.warps, pattern: sd.draft.pattern}));
        new_sd.setComponentSize(sd.bounds.width, sd.bounds.height);
        new_sd.setComponentPosition({
          x: sd.bounds.topleft.x + sd.bounds.width + this.scale *2, 
          y: sd.bounds.topleft.y});
        new_sd.drawDraft();
        
   }

  /**
   * A mouse event, originated in a subdraft, has been started
   * checkes the design mode and handles the event as required
   * @param obj contains the id of the moving subdraft
   */
  subdraftStarted(obj: any){
    console.log(&quot;obj&quot;, obj);
    if(obj &#x3D;&#x3D;&#x3D; null) return;

    if(this.design_modes.isSelected(&quot;move&quot;)){
  
      //get the reference to the draft that&#x27;s moving
      const moving &#x3D; &lt;SubdraftComponent&gt; this.tree.getComponent(obj.id);
      if(moving &#x3D;&#x3D;&#x3D; null) return; 


      this.startSnackBar(&quot;Using Ink: &quot;+moving.ink, moving.bounds);
      
      const isect:Array&lt;SubdraftComponent&gt; &#x3D; this.getIntersectingSubdrafts(moving);

      if(isect.length &#x3D;&#x3D; 0) return;
      
      const bounds: any &#x3D; utilInstance.getCombinedBounds(moving, isect);
      const temp: Draft &#x3D; this.getCombinedDraft(bounds, moving, isect);
      this.createAndSetPreview(temp);
      this.preview.drawDraft();
      this.preview.setComponentPosition(bounds.topleft);
     
    }else if(this.design_modes.isSelected(&quot;select&quot;)){
      this.selectionStarted();
    }else if(this.design_modes.isSelected(&quot;draw&quot;)){
      this.drawStarted();
    }

 }

 /**
  * triggers a mode that allows mouse-mouse to be followed by a line.
  * @param obj - contains event, id of component who called
  */
 selectInputDraft(obj: any){
  this.connection_op_id &#x3D; obj.id;
  const op: OperationComponent &#x3D; &lt;OperationComponent&gt; this.tree.getComponent(obj.id);
  this.changeDesignmode(&#x27;operation&#x27;);
  this.connectionStarted(op.bounds.topleft);

 }

 /**
 * adds a connector flag to any subdrafts that we are allowed to connect to from this operation
 */
  setDraftsConnectable(op_id: number){
    const nodes: Array&lt;SubdraftComponent&gt; &#x3D; this.tree.getDrafts();
    const op: OperationComponent &#x3D; &lt;OperationComponent&gt; this.tree.getComponent(op_id);
    const inputs: Array&lt;number&gt; &#x3D; this.tree.getInputs(op_id);
    if(inputs.length &gt;&#x3D; op.maxInputs()){
      nodes.forEach(el &#x3D;&gt; {
        console.log(&quot;inputs longer unsettiing for&quot;, el.id)
        el.unsetConnectable();

        //now unset the ones that are already assigned to other ops
        const connections: Array&lt;number&gt; &#x3D; this.tree.getNonCxnOutputs(el.id);
        const op_ndx: number &#x3D; connections.findIndex(id &#x3D;&gt; (id &#x3D;&#x3D;&#x3D; op_id));
        console.log(connections, &quot;found at &quot;, op_ndx);
        //if it had connections and the connection was not this operation, unset it
        if(op_ndx !&#x3D;&#x3D; -1){
          el.setConnectable();
        }    
      });
    }else{

      nodes.forEach(el &#x3D;&gt; {

        //look upstream to see if this operation is linked in any way to this op
        const upstream: Array&lt;number&gt; &#x3D; this.tree.getUpstreamOperations(el.id);
        const ndx: number &#x3D; upstream.findIndex(i &#x3D;&gt; i &#x3D;&#x3D;&#x3D; op_id);
        if(ndx &#x3D;&#x3D;&#x3D; -1) el.setConnectable();
  
        //now unset the ones that are already assigned to other ops
        const connections: Array&lt;number&gt; &#x3D; this.tree.getOutputs(el.id);
        const ops: Array&lt;number&gt; &#x3D; connections.map(cxn &#x3D;&gt; this.tree.getConnectionOutput(cxn));
        const op_ndx: number &#x3D; ops.findIndex(op &#x3D;&gt; (op &#x3D;&#x3D;&#x3D; op_id));
        //if it had connections and the connection was not this operation, unset it
        if(ops.length &gt; 0 &amp;&amp; op_ndx &#x3D;&#x3D;&#x3D; -1){
          el.unsetConnectable();
        }    
  
      });
    }
   
   }

    /**
 * disables selection and pointer events on all
 */
  unsetDraftsConnectable(){
    const nodes: Array&lt;SubdraftComponent&gt; &#x3D; this.tree.getDrafts();
    nodes.forEach(el &#x3D;&gt; {
      el.unsetConnectable();
    });
   }

/**
 * disables selection and pointer events on all
 */
 freezePaletteObjects(){
  const nodes: Array&lt;any&gt; &#x3D; this.tree.getComponents();
  nodes.forEach(el &#x3D;&gt; {
    el.disableDrag();
  });
 }

 /**
 * freezes all palette objects
 */
  unfreezePaletteObjects(){
    const nodes: Array&lt;any&gt; &#x3D; this.tree.getComponents();
    nodes.forEach(el &#x3D;&gt; {
      el.enableDrag();
    });
   }
  

 /**
  * called when a connection event starts
  */
 connectionStarted(topleft: Point){
  this.selecting_connection &#x3D; true;
  this.unfreezePaletteObjects();
  this.setDraftsConnectable(this.connection_op_id);

  this.shape_bounds &#x3D; {
    topleft: topleft,
    width: this.scale,
    height: this.scale
  };

  this.startSnackBar(&quot;Click an empty space on the palette to stop selecting&quot;, this.shape_bounds);
 }

 /**
   * draws when a user is using the mouse to identify an input to a component
   * @param mouse the absolute position of the mouse on screen
   * @param shift boolean representing if shift is pressed as well 
   */
connectionDragged(mouse: Point, shift: boolean){


  this.shape_bounds.width &#x3D;  (mouse.x - this.shape_bounds.topleft.x);
  this.shape_bounds.height &#x3D;  (mouse.y - this.shape_bounds.topleft.y);

  if(shift){

  }

  this.cx.clearRect(0, 0, this.canvas.width, this.canvas.height);
  this.cx.beginPath();
  this.cx.fillStyle &#x3D; &quot;#ff4081&quot;;
  this.cx.strokeStyle &#x3D; &quot;#ff4081&quot;;
  this.cx.setLineDash([this.scale, 2]);
  this.cx.lineWidth &#x3D; 2;


  this.cx.moveTo(this.shape_bounds.topleft.x+this.scale, this.shape_bounds.topleft.y+this.scale);
  this.cx.lineTo(this.shape_bounds.topleft.x + this.shape_bounds.width, this.shape_bounds.topleft.y + this.shape_bounds.height);
  this.cx.stroke();
 

}


/**
 * converts the shape on screen to a component
 */
 processConnectionEnd(){
  this.closeSnackBar();
  this.selecting_connection &#x3D; false;
  this.unsetDraftsConnectable();
  this.cx.clearRect(0, 0, this.canvas.width, this.canvas.height);
} 

/**
 * given a node id, calculate any drafts that take place &quot;downstream&quot; from this draft
 * @param id 
 */
recalculateDownstreamDrafts(downstream_ops:Array&lt;number&gt;){
  //recalculate downstream drafts
  downstream_ops.forEach(op &#x3D;&gt; {
    this.performOp(op);
  });
}


performOp(op_id:number){
  const op:OperationComponent &#x3D; &lt;OperationComponent&gt;this.tree.getComponent(op_id);
  const inputs: Array&lt;number&gt; &#x3D;  this.tree.getNonCxnInputs(op_id);

  console.log(&quot;inputs are&quot;, inputs);
  const input_drafts: Array&lt;Draft&gt; &#x3D; inputs.map(input &#x3D;&gt; {
    const  sd:SubdraftComponent &#x3D; &lt;SubdraftComponent&gt; this.tree.getNode(input).component;
    return sd.draft;
   });

  
  const draft_map: Array&lt;DraftMap&gt; &#x3D; op.perform(input_drafts);

  console.log(&quot;created draft map&quot;, draft_map);
  draft_map.forEach(el &#x3D;&gt; {
    let sd:SubdraftComponent &#x3D; null;

    if(el.component_id &gt;&#x3D; 0){
       sd &#x3D; &lt;SubdraftComponent&gt; this.tree.getComponent(el.component_id);
       sd.setNewDraft(el.draft);
    }else{

      sd &#x3D; this.createSubDraft(el. draft);
      const pos: Point &#x3D; op.bounds.topleft;
      op.addOutput({component_id: sd.id, draft:el.draft});
      sd.setComponentPosition({x: pos.x, y: pos.y + op.bounds.height});
      sd.setComponentSize(el.draft.warps * this.scale, el.draft.wefts * this.scale);
      sd.setParent(op.id);
      this.createConnection(op.id, sd.id);
      this.tree.setSubdraftParent(sd.id, op.id);
      
    }

    op.setWidth(sd.bounds.width);
    sd.drawDraft();
  });

}

/**
 * emitted from subdraft when it receives a hit on its connection button, the id refers to the subdraft id
 */
connectionMade(sd_id:number){

  //this is defined in the order that the line was drawn
  // const sd:SubdraftComponent &#x3D; &lt;SubdraftComponent&gt;this.tree.getComponent(id);
  this.createConnection(sd_id, this.connection_op_id);
  this.performOp(this.connection_op_id);
  this.processConnectionEnd();
}

/**
 * emitted from subdraft when it receives a hit on its connection button but already 
 * had something assigned there
 * @param id the subdraft id that called the function
 */
 removeConnection(sd_id:number){
  console.log(&quot;removing connection to subdraft&quot;, sd_id);


  const cxn:ConnectionComponent &#x3D; &lt;ConnectionComponent&gt;this.tree.getConnectionComponentFromSubdraft(sd_id);
  const from: number &#x3D; this.tree.getConnectionInput(cxn.id); // get the outputs from this conection - thre should only be one
  const to:number &#x3D; this.tree.getConnectionOutput(cxn.id); // get the outputs from this conection - thre should only be one
  const downstream:Array&lt;number&gt; &#x3D; this.tree.getDownstreamOperations(cxn.id);
  const inputs_to_update: Array&lt;number&gt; &#x3D; this.tree.getNonCxnInputs(to);
  const from_comp: any &#x3D; this.tree.getComponent(from);
  const from_order_id &#x3D; from_comp.active_connection_order;
  
  //upddate the assignment order on input subdrafts
  inputs_to_update.forEach((el) &#x3D;&gt; {
    const comp: any &#x3D; this.tree.getComponent(el);
    if(comp.active_connection_order &#x3D;&#x3D; from_order_id) comp.active_connection_order &#x3D; 0;
    if(comp.active_connection_order &gt; from_order_id) comp.active_connection_order--;
  });

  const view_ref &#x3D; this.tree.getViewRef(cxn.id);
  this.removeFromViewContainer(view_ref);
  this.tree.removeNode(cxn.id);
  const to_delete:Array&lt;number&gt; &#x3D; this.tree.getUnusuedConnections();
  if(to_delete.length &gt; 0) console.log(&quot;Error: Removing Connection triggered other deletions&quot;);

  //this list has to be calculated before the node is deleted, and udpated after
  this.recalculateDownstreamDrafts(downstream);
  this.processConnectionEnd();

}

 

 selectionStarted(){

  this.selection.start &#x3D; this.last;
  this.selection.active &#x3D; true;
  this.startSnackBar(&quot;Select Drafts to Join&quot;, this.selection.bounds);
 }

 /**
 * brings the base canvas to view and begins to render the
 * @param mouse the absolute position of the mouse on screen
 */
shapeStarted(mouse: Point){
  
  this.shape_bounds &#x3D; {
    topleft: mouse,
    width: this.scale,
    height: this.scale
  };


  this.shape_vtxs &#x3D; [];
  this.canvas_zndx &#x3D; this.layers.createLayer(); //bring this canvas forward
  this.cx.fillStyle &#x3D; &quot;#ff4081&quot;;
  this.cx.fillRect( this.shape_bounds.topleft.x, this.shape_bounds.topleft.y, this.shape_bounds.width,this.shape_bounds.height);
  
  if(this.design_modes.isSelected(&#x27;free&#x27;)){
    this.startSnackBar(&quot;CTRL+Click to end drawing&quot;, this.shape_bounds);
  }else{
    this.startSnackBar(&quot;Press SHIFT while dragging to constrain shape&quot;, this.shape_bounds);
  }
 

}

  /**
   * resizes and redraws the shape between the the current mouse and where the shape started
   * @param mouse the absolute position of the mouse on screen
   */
shapeDragged(mouse: Point, shift: boolean){

  this.shape_bounds.width &#x3D;  (mouse.x - this.shape_bounds.topleft.x);
  this.shape_bounds.height &#x3D;  (mouse.y - this.shape_bounds.topleft.y);

  if(shift){
    const max: number &#x3D; Math.max(this.shape_bounds.width, this.shape_bounds.height);
    
    //allow lines to snap to coords
    if(this.design_modes.isSelected(&#x27;line&#x27;)){
        if(Math.abs(this.shape_bounds.width) &lt; Math.abs(this.shape_bounds.height/2)){
          this.shape_bounds.height &#x3D; max;
          this.shape_bounds.width &#x3D; this.scale;
        }else if(Math.abs(this.shape_bounds.height) &lt; Math.abs(this.shape_bounds.width/2)){
          this.shape_bounds.width &#x3D; max;
          this.shape_bounds.height &#x3D; this.scale;
        }else{
          this.shape_bounds.width &#x3D; max;
          this.shape_bounds.height &#x3D; max;  
        }
        
    }else{
      this.shape_bounds.width &#x3D; max;
      this.shape_bounds.height &#x3D; max;    
  
    }
  }

  this.cx.clearRect(0, 0, this.canvas.width, this.canvas.height);
  this.cx.beginPath();
  this.cx.fillStyle &#x3D; &quot;#ff4081&quot;;
  this.cx.strokeStyle &#x3D; &quot;#ff4081&quot;;
  this.cx.setLineDash([]);
  this.cx.lineWidth &#x3D; this.scale;

  if(this.design_modes.isSelected(&#x27;line&#x27;)){
    this.cx.moveTo(this.shape_bounds.topleft.x+this.scale, this.shape_bounds.topleft.y+this.scale);
    this.cx.lineTo(this.shape_bounds.topleft.x + this.shape_bounds.width, this.shape_bounds.topleft.y + this.shape_bounds.height);
    this.cx.stroke();
  }else if(this.design_modes.isSelected(&#x27;fill_circle&#x27;)){
    this.shape_bounds.width &#x3D; Math.abs(this.shape_bounds.width);
    this.shape_bounds.height &#x3D; Math.abs(this.shape_bounds.height);
    this.cx.ellipse(this.shape_bounds.topleft.x, this.shape_bounds.topleft.y, this.shape_bounds.width, this.shape_bounds.height, 2 * Math.PI, 0,  this.shape_bounds.height/2);
    this.cx.fill();
  }else if(this.design_modes.isSelected(&#x27;stroke_circle&#x27;)){
    this.cx.ellipse(this.shape_bounds.topleft.x, this.shape_bounds.topleft.y, this.shape_bounds.width, this.shape_bounds.height, 2 * Math.PI, 0,  this.shape_bounds.height/2);
    this.cx.stroke();
  }else if(this.design_modes.isSelected(&#x27;fill_rect&#x27;)){
    this.cx.fillRect(this.shape_bounds.topleft.x, this.shape_bounds.topleft.y,this.shape_bounds.width,this.shape_bounds.height);
  
  }else if(this.design_modes.isSelected(&#x27;stroke_rect&#x27;)){
    this.cx.strokeRect(this.shape_bounds.topleft.x + this.scale, this.shape_bounds.topleft.y+ this.scale,this.shape_bounds.width- this.scale,this.shape_bounds.height-this.scale);

  }else{

    if(this.shape_vtxs.length &gt; 1){
      this.cx.moveTo(this.shape_vtxs[0].x, this.shape_vtxs[0].y);

      for(let i &#x3D; 1; i &lt; this.shape_vtxs.length; i++){
        this.cx.lineTo(this.shape_vtxs[i].x, this.shape_vtxs[i].y);
        //this.cx.moveTo(this.shape_vtxs[i].x, this.shape_vtxs[i].y);
      }

    }else{
      this.cx.moveTo(this.shape_bounds.topleft.x, this.shape_bounds.topleft.y);
    }

    this.cx.lineTo(this.shape_bounds.topleft.x + this.shape_bounds.width, this.shape_bounds.topleft.y + this.shape_bounds.height);
    this.cx.stroke();
    this.cx.fill();
    
  }

  if(this.design_modes.isSelected(&#x27;free&#x27;)){
    this.updateSnackBar(&quot;CTRL+click to end drawing&quot;, this.shape_bounds);
  }else{
    this.updateSnackBar(&quot;Press SHIFT to contstrain shape&quot;, this.shape_bounds);
  }
}

/**
 * converts the shape on screen to a component
 */
processShapeEnd(){
  this.closeSnackBar();

  //if circle, the topleft functoins as the center and the bounsd need to expand to fit the entire shape 
  if(this.design_modes.isSelected(&#x27;fill_circle&#x27;) || this.design_modes.isSelected(&#x27;stroke_circle&#x27;)){
    this.shape_bounds.topleft.x -&#x3D;  this.shape_bounds.width;
    this.shape_bounds.topleft.y -&#x3D;  this.shape_bounds.height;
    this.shape_bounds.width *&#x3D;2;
    this.shape_bounds.height *&#x3D; 2;
  }else if(this.design_modes.isSelected(&#x27;free&#x27;)){
    
    if(this.shape_vtxs.length &#x3D;&#x3D;&#x3D; 0) return;
      //default to current segment
    let top &#x3D; this.shape_bounds.topleft.y;
    let left &#x3D; this.shape_bounds.topleft.x;
    let bottom &#x3D; this.shape_bounds.topleft.y +this.shape_bounds.height;
    let right &#x3D; this.shape_bounds.topleft.x +this.shape_bounds.width;
    
    //iteraate through the poitns and find the leftmost and topmost 
    for(let i &#x3D; 1; i &lt; this.shape_vtxs.length; i++ ){
        if(this.shape_vtxs[i].y &lt; top) top &#x3D; this.shape_vtxs[i].y;
        if(this.shape_vtxs[i].x &lt; left) left &#x3D; this.shape_vtxs[i].x;
        if(this.shape_vtxs[i].y &gt; bottom) bottom &#x3D; this.shape_vtxs[i].y;
        if(this.shape_vtxs[i].x &gt; right) right &#x3D; this.shape_vtxs[i].x;
    }

    this.shape_bounds.topleft &#x3D; {x: left, y: top};
    this.shape_bounds.width &#x3D; right - left;
    this.shape_bounds.height &#x3D; bottom - top;

    this.shape_vtxs &#x3D; [];
    
  }else{
    if( this.shape_bounds.width &lt; 0){
      this.shape_bounds.width &#x3D; Math.abs(this.shape_bounds.width);
      this.shape_bounds.topleft.x-&#x3D; this.shape_bounds.width
    }  

    if( this.shape_bounds.height &lt; 0){
      this.shape_bounds.height &#x3D; Math.abs(this.shape_bounds.height);
      this.shape_bounds.topleft.y-&#x3D; this.shape_bounds.height
    }  
  }
  
  const shape: Shape &#x3D; new Shape(this.canvas, this.shape_bounds, this.scale); 
  //const img_data &#x3D; shape.getImageData();
  // this.cx.clearRect(0, 0, this.canvas.width, this.canvas.height);
  // this.cx.putImageData(img_data, 0, 0);
  const pattern: Array&lt;Array&lt;Cell&gt;&gt; &#x3D; shape.getDraft();

  const wefts: number &#x3D; pattern.length;
  if(wefts &lt;&#x3D; 0) return;
  const warps: number &#x3D; pattern[0].length;

  const sd:SubdraftComponent &#x3D; this.createSubDraft(new Draft({wefts: wefts,  warps: warps, pattern: pattern}));
  sd.setComponentPosition(this.shape_bounds.topleft);
  sd.setComponentSize(this.shape_bounds.width, this.shape_bounds.height);
  sd.disableDrag();
  
}

/**
 * clears the scratchpad for the new drawing event
 */
drawStarted(){

  this.canvas_zndx &#x3D; this.layers.createLayer(); //bring this canvas forward
  this.scratch_pad &#x3D; [];
  for(let i &#x3D; 0; i &lt; this.canvas.height; i+&#x3D;this.scale ){
      const row &#x3D; [];
      for(let j &#x3D; 0; j&lt; this.canvas.width; j+&#x3D;this.scale ){
          row.push(new Cell(null));
      }
    this.scratch_pad.push(row);
    }

    this.startSnackBar(&quot;Drag to Draw&quot;, null);
  }


  /**
   * gets the bounds of a drawing on the scratchpad, a drawing is represented by set cells
   * @returns an object representing the bounds in the format of i, j (the row, column index of the pad)
   */
  getScratchPadBounds(): Array&lt;Interlacement&gt;{
    let bottom: number &#x3D; 0;
    let right: number &#x3D; 0;
    let top: number &#x3D; this.scratch_pad.length-1;
    let left: number &#x3D; this.scratch_pad[0].length-1;

    for(let i &#x3D; 0; i &lt; this.scratch_pad.length; i++ ){
      for(let j &#x3D; 0; j&lt;  this.scratch_pad[0].length; j++){
        if((this.scratch_pad[i][j].isSet())){
          if(i &lt; top) top &#x3D; i;
          if(j &lt; left) left &#x3D; j;
          if(i &gt; bottom) bottom &#x3D; i;
          if(j &gt; right) right &#x3D; j;
        } 
      }
    }

    return [{i: top, j: left, si: -1}, {i: bottom, j: right, si: -1}];

  }

  /**
   * handles checks and actions to take when drawing event ends
   * gets the boudary of drawn segment and creates a subdraft containing that drawing
   * if the drawing sits on top of an existing subdraft, merge the drawing into that subdraft (extending the original if neccessary)
   * @returns 
   */
  processDrawingEnd(){

    this.canvas_zndx &#x3D; -1;

    if(this.scratch_pad &#x3D;&#x3D;&#x3D; undefined) return;
    if(this.scratch_pad[0] &#x3D;&#x3D;&#x3D; undefined) return;
    
    const corners: Array&lt;Interlacement&gt; &#x3D; this.getScratchPadBounds();

    const warps &#x3D; corners[1].j - corners[0].j + 1;
    const wefts &#x3D; corners[1].i - corners[0].i + 1;

  
    //there must be at least one cell selected
    if(warps &lt; 1 || wefts &lt; 1){
      this.scratch_pad &#x3D; undefined;
      return;
    } 

    //if this drawing does not intersect with any existing subdrafts, 
    const sd:SubdraftComponent &#x3D; this.createSubDraft(new Draft({wefts: wefts,  warps: warps}));
    const pos &#x3D; {
      topleft: {x: corners[0].j * this.scale, y: corners[0].i * this.scale},
      width: warps * this.scale,
      height: wefts * this.scale
    }

    sd.setComponentPosition(pos.topleft);
    sd.setComponentSize(pos.width, pos.height);
    sd.disableDrag();


    for(let i &#x3D; 0; i &lt; sd.draft.wefts; i++ ){
      for(let j &#x3D; 0; j&lt; sd.draft.warps; j++){
        const c &#x3D; this.scratch_pad[corners[0].i+i][corners[0].j+j];
        const b &#x3D; this.getScratchpadProduct({i:i, j:j, si:-1}, this.inks.getSelected(),c);
        sd.draft.pattern[i][j].setHeddle(b); 
      }
    }

    // const had_merge &#x3D; this.mergeSubdrafts(sd);
    // console.log(&quot;had a merge?&quot;, had_merge);

  }


 /**
  * handles actions to take when the mouse is down inside of the palette
  * @param event the mousedown event
  */
  @HostListener(&#x27;mousedown&#x27;, [&#x27;$event&#x27;])
    private onStart(event) {

      console.log(&quot;mouse down detected!&quot;);
      const ctrl: boolean &#x3D; event.ctrlKey;
      const mouse:Point &#x3D; {x: this.viewport.topleft.x + event.clientX, y:this.viewport.topleft.y+event.clientY};
      const ndx:any &#x3D; utilInstance.resolveCoordsToNdx(mouse, this.scale);

      //use this to snap the mouse to the nearest coord
      mouse.x &#x3D; ndx.j * this.scale;
      mouse.y &#x3D; ndx.i * this.scale;

      
      this.last &#x3D; ndx;
      this.selection.start &#x3D; this.last;
      this.removeSubscription();    
      
     
      if(this.design_modes.isSelected(&quot;select&quot;)){
          this.selectionStarted();
          this.moveSubscription &#x3D; 
          fromEvent(event.target, &#x27;mousemove&#x27;).subscribe(e &#x3D;&gt; this.onDrag(e)); 
    
      }else if(this.design_modes.isSelected(&quot;draw&quot;)){
        this.moveSubscription &#x3D; 
        fromEvent(event.target, &#x27;mousemove&#x27;).subscribe(e &#x3D;&gt; this.onDrag(e)); 
  
          this.drawStarted();    
          this.setCell(ndx);
          this.drawCell(ndx); 
      }else if(this.design_modes.isSelected(&quot;shape&quot;)){
        this.moveSubscription &#x3D; 
        fromEvent(event.target, &#x27;mousemove&#x27;).subscribe(e &#x3D;&gt; this.onDrag(e)); 
  

        if(this.design_modes.isSelected(&#x27;free&#x27;)){
          if(ctrl){
            this.processShapeEnd();
            this.changeDesignmode(&#x27;move&#x27;);
            this.cx.clearRect(0, 0, this.canvas.width, this.canvas.height);
          }else{
            if(this.shape_vtxs.length &#x3D;&#x3D; 0) this.shapeStarted(mouse);
            this.shape_vtxs.push(mouse);
          }
            
          
        }else{
          this.shapeStarted(mouse);
        }
      }else if(this.design_modes.isSelected(&quot;operation&quot;)){
        this.processConnectionEnd();
        this.changeDesignmode(&#x27;move&#x27;);
      }
  }


  @HostListener(&#x27;mousemove&#x27;, [&#x27;$event&#x27;])
  private onMove(event) {
    const shift: boolean &#x3D; event.shiftKey;
    const mouse:Point &#x3D; {x: this.viewport.topleft.x + event.clientX, y:this.viewport.topleft.y+event.clientY};
    const ndx:any &#x3D; utilInstance.resolveCoordsToNdx(mouse, this.scale);
    mouse.x &#x3D; ndx.j * this.scale;
    mouse.y &#x3D; ndx.i * this.scale;

    if(this.design_modes.isSelected(&#x27;free&#x27;) &amp;&amp; this.shape_vtxs.length &gt; 0){
      this.shapeDragged(mouse, shift);
    }else if(this.selecting_connection){
      this.connectionDragged(mouse, shift);
    }
  }
  
 /**
  * called when the operation input is selected and used to draw
   * @param event the event object
   */
  mouseSelectingDraft(event: any, id: number){

    const shift: boolean &#x3D; event.shiftKey;
    const mouse: Point &#x3D; {x: this.viewport.topleft.x + event.clientX, y:this.viewport.topleft.y+event.clientY};
    const ndx:Interlacement &#x3D; utilInstance.resolveCoordsToNdx(mouse, this.scale);
    //use this to snap the mouse to the nearest coord
    mouse.x &#x3D; ndx.j * this.scale;
    mouse.y &#x3D; ndx.i * this.scale;

    if(utilInstance.isSameNdx(this.last, ndx)) return;

    if(this.design_modes.isSelected(&quot;operation&quot;)){

     
    
    }
    
    this.last &#x3D; ndx;
  }

  /**
   * called form the subscription created on start, checks the index of the location and returns null if its the same
   * @param event the event object
   */
  onDrag(event){


    const shift: boolean &#x3D; event.shiftKey;
    const mouse: Point &#x3D; {x: this.viewport.topleft.x + event.clientX, y:this.viewport.topleft.y+event.clientY};
    const ndx:Interlacement &#x3D; utilInstance.resolveCoordsToNdx(mouse, this.scale);
    //use this to snap the mouse to the nearest coord
    mouse.x &#x3D; ndx.j * this.scale;
    mouse.y &#x3D; ndx.i * this.scale;

    if(utilInstance.isSameNdx(this.last, ndx)) return;

    if(this.design_modes.isSelected(&quot;select&quot;)){

     this.drawSelection(ndx);
     const bounds &#x3D; this.getSelectionBounds(this.selection.start,  this.last);    
     this.selection.setPositionAndSize(bounds);
     this.updateSnackBar(&quot;Select Drafts to Join&quot;,  this.selection.bounds);

    
    }else if(this.design_modes.isSelected(&quot;draw&quot;)){
      this.setCell(ndx);
      this.drawCell(ndx);
    }else if(this.design_modes.isSelected(&quot;shape&quot;)){
      this.shapeDragged(mouse, shift);
    }
    
    this.last &#x3D; ndx;
  }

  

/**
 * Called when the mouse is up or leaves the boundary of the view
 * @param event 
 * @returns 
 */
  @HostListener(&#x27;mouseleave&#x27;, [&#x27;$event&#x27;])
  @HostListener(&#x27;mouseup&#x27;, [&#x27;$event&#x27;])
     private onEnd(event) {

      //if this.last is null, we have a mouseleave with no mousestart
      if(this.last &#x3D;&#x3D;&#x3D; undefined) return;
      const mouse: Point &#x3D; {x: this.viewport.topleft.x + event.clientX, y:this.viewport.topleft.y+event.clientY};
      const ndx:Interlacement &#x3D; utilInstance.resolveCoordsToNdx(mouse, this.scale);
      //use this to snap the mouse to the nearest coord
      mouse.x &#x3D; ndx.j * this.scale;
      mouse.y &#x3D; ndx.i * this.scale;

      this.removeSubscription();   

      if(this.design_modes.isSelected(&quot;select&quot;)){
        if(this.selection.active)this.processSelection();
        this.closeSnackBar();
        this.cx.clearRect(0, 0, this.canvas.width, this.canvas.height);
        this.changeDesignmode(&#x27;move&#x27;);

      }else if(this.design_modes.isSelected(&quot;draw&quot;)){
        this.processDrawingEnd();
        this.closeSnackBar();
        this.cx.clearRect(0, 0, this.canvas.width, this.canvas.height);
        this.changeDesignmode(&#x27;move&#x27;);


      }else if(this.design_modes.isSelected(&quot;shape&quot;)){
        if(!this.design_modes.isSelected(&#x27;free&#x27;)){
          this.processShapeEnd();
          this.changeDesignmode(&#x27;move&#x27;);
          this.cx.clearRect(0, 0, this.canvas.width, this.canvas.height);
        }
      }

      //unset vars that would have been created on press
      this.scratch_pad &#x3D; undefined;
      this.last &#x3D; undefined;
      this.selection.active &#x3D; false;
  }
  
 
  /**
   * Called when a selection operation ends. Checks to see if this selection intersects with any subdrafts and 
   * merges and or splits as required. 
   */
  processSelection(){

    this.closeSnackBar();

    //create the selection as subdraft
    const bounds:Bounds &#x3D; this.getSelectionBounds(this.selection.start,  this.last);    
    
    const sc:SubdraftComponent &#x3D; this.createSubDraft(new Draft({wefts: bounds.height/this.scale, warps: bounds.width/this.scale}));
    sc.setComponentBounds(bounds);
    sc.disableDrag();
    
    //get any subdrafts that intersect the one we just made
    const isect:Array&lt;SubdraftComponent&gt; &#x3D; this.getIntersectingSubdrafts(sc);

    if(isect.length &#x3D;&#x3D; 0) return;

    //get a draft that reflects only the poitns in the selection view
    const new_draft: Draft &#x3D; this.getCombinedDraft(bounds, sc, isect);
    sc.setNewDraft(new_draft);
    sc.drawDraft();

    isect.forEach(el &#x3D;&gt; {
      const ibound &#x3D; utilInstance.getIntersectionBounds(sc, el);

      if(el.isSameBoundsAs(ibound)){
         console.log(&quot;Component had same Bounds as Intersection, Consumed&quot;);
         this.removeSubdraft(el.id);
      }else{
         const sd_draft &#x3D; el.draft.pattern;
         for(let i &#x3D; 0; i &lt; sd_draft.length; i++){
           for(let j &#x3D; 0; j &lt; sd_draft[i].length; j++){
           
              let p:Point &#x3D; el.resolveNdxToPoint({i: i, j: j, si: -1});
              p.x +&#x3D; this.scale/2;
              p.y +&#x3D; this.scale/2;
              if(sc.hasPoint(p)) sd_draft[i][j].unsetHeddle();
           }
         }
         
        el.drawDraft();
        }
    });
  }

  updateAttachedComponents(obj: any){
    const moving : any &#x3D; this.tree.getComponent(obj.id);
    const updates: Array&lt;number&gt; &#x3D; this.tree.getNodesToUpdateOnMove(obj.id);

    updates.forEach(u &#x3D;&gt; {
      const type: string &#x3D; this.tree.getType(u);
      const u_comp &#x3D; this.tree.getComponent(u);
      //if this is a node that didn&#x27;t call the command, its a parent or child. 
      if(obj.id !&#x3D;&#x3D; u){
         if(type&#x3D;&#x3D;&#x27;op&#x27;) u_comp.setPosition({x: obj.point.x, y: obj.point.y - 30});
         if(type&#x3D;&#x3D;&#x27;draft&#x27;) u_comp.setPosition({x: obj.point.x, y: obj.point.y + 30});         
      
         const cxns: Array&lt;number&gt; &#x3D; this.tree.getNodeConnections(u);
         cxns.forEach(cxn &#x3D;&gt; {
           const comp: ConnectionComponent &#x3D; &lt;ConnectionComponent&gt;this.tree.getComponent(cxn);
            if(type&#x3D;&#x3D;&#x27;op&#x27;) comp.updatePositionAndSize(u_comp.id,  {x: obj.point.x, y: obj.point.y-30}, u_comp.bounds.width, u_comp.bounds.height);
            if(type&#x3D;&#x3D;&#x27;draft&#x27;) comp.updatePositionAndSize(u_comp.id, {x: obj.point.x, y: obj.point.y}, u_comp.bounds.width, u_comp.bounds.height);  
         });
      
      }else{

        const cxns: Array&lt;number&gt; &#x3D; this.tree.getNodeConnections(u);
        cxns.forEach(cxn &#x3D;&gt; {
          const comp: ConnectionComponent &#x3D; &lt;ConnectionComponent&gt;this.tree.getComponent(cxn);
          comp.updatePositionAndSize(moving.id, obj.point, moving.bounds.width, moving.bounds.height);
        })
      }
     }); 
  }


  /**
   * emitted from a subdraft when an internal action has changeded its value 
   * checks for a child subdraft, recomputes, redraws. 
   * @param obj with attribute id describing the subdraft that called this
   * @returns 
   */
  onSubdraftAction(obj: any){
    if(obj &#x3D;&#x3D;&#x3D; null) return;
    const ds: Array&lt;number&gt; &#x3D; this.tree.getDownstreamOperations(obj.id);
    this.recalculateDownstreamDrafts(ds);
  }

  /**
   * emitted from an operatioin when its param has changed 
   * checks for a child subdraft, recomputes, redraws. 
   * @param obj with attribute id describing the operation that called this
   * @returns 
   */
   operationParamChanged(obj: any){
    if(obj &#x3D;&#x3D;&#x3D; null) return;

    this.performOp(obj.id);
    const ds: Array&lt;number&gt; &#x3D; this.tree.getDownstreamOperations(obj.id);
    this.recalculateDownstreamDrafts(ds);

  }


/**
 * called from an operatiino cmoponent when it is dragged
 * @param obj (id, point of toplleft)
 */
  operationMoved(obj: any){
    if(obj &#x3D;&#x3D;&#x3D; null) return;

    //get the reference to the draft that&#x27;s moving
    const moving &#x3D; &lt;OperationComponent&gt; this.tree.getComponent(obj.id);
    if(moving &#x3D;&#x3D;&#x3D; null) return; 
    this.updateSnackBar(&quot;moving opereation &quot;+moving.name,moving.bounds);
    this.updateAttachedComponents(obj);

  }



  subdraftMoved(obj: any){
      if(obj &#x3D;&#x3D;&#x3D; null) return;
  
      //get the reference to the draft that&#x27;s moving
      const moving &#x3D; &lt;SubdraftComponent&gt; this.tree.getComponent(obj.id);
      if(moving &#x3D;&#x3D;&#x3D; null) return; 

      this.updateSnackBar(&quot;Using Ink: &quot;+moving.ink,moving.bounds);
      
      this.updateAttachedComponents(obj);

      // const updates: Array&lt;number&gt; &#x3D; this.tree.getNodesToUpdateOnMove(obj.id);
      // updates.forEach(u &#x3D;&gt; {
      //   const comp: any &#x3D; this.tree.getComponent(u);
      //   comp.updatePositionAndSize(moving.id, obj.point, moving.bounds.width, moving.bounds.height);
      // }); 

      const isect:Array&lt;SubdraftComponent&gt; &#x3D; this.getIntersectingSubdrafts(moving);
      
      if(isect.length &#x3D;&#x3D; 0){
        if(this.hasPreview()) this.removePreview();
        return;
      } 

      //const bounds: Bounds &#x3D; this.getIntersectionBounds(moving, isect[0]);
      const bounds: Bounds &#x3D; utilInstance.getCombinedBounds(moving, isect);
      const temp: Draft &#x3D; this.getCombinedDraft(bounds, moving, isect);
      if(this.hasPreview()) this.preview.setNewDraft(temp);
      else this.createAndSetPreview(temp);
      this.preview.setComponentPosition(bounds.topleft);
      this.preview.drawDraft();



      
    }


   /**
    * checks if this subdraft has been dropped onto of another and merges them accordingly 
    * @param obj 
    * @returns 
    */
  subdraftDropped(obj: any){

    this.closeSnackBar();

     if(obj &#x3D;&#x3D;&#x3D; null) return;
  
      //creaet a subdraft of this intersection
      if(this.hasPreview()){
        const sd: SubdraftComponent &#x3D; this.createSubDraft(new Draft({wefts: this.preview.draft.wefts, warps: this.preview.draft.warps}));
        const to_right: Point &#x3D; this.preview.getTopleft();
        to_right.x +&#x3D; this.preview.bounds.width + this.scale *4;
        sd.draft.pattern &#x3D; cloneDeep(this.preview.draft.pattern);
        sd.setComponentPosition(to_right);
        sd.setComponentSize(this.preview.bounds.width, this.preview.bounds.height);
        sd.zndx &#x3D; this.layers.createLayer();
        this.removePreview();
      } 

      
      
      //get the reference to the draft that&#x27;s moving
      const moving &#x3D; this.tree.getComponent(obj.id);
      if(moving &#x3D;&#x3D;&#x3D; null) return; 


      

      //disable this too see what happens
      // const had_merge &#x3D; this.mergeSubdrafts(moving);
      // console.log(&quot;had merge&quot;, had_merge);
      // if(!had_merge) 
      // moving.drawDraft();

  }

  /**
   * merges a collection of subdraft components into the primary component, deletes the merged components
   * @param primary the draft to merge into
   * @returns true or false to describe if a merge took place. 
   */
  mergeSubdrafts(primary: SubdraftComponent): boolean{
    console.log(&quot;primary&quot;, primary);

    const isect:Array&lt;SubdraftComponent&gt; &#x3D; this.getIntersectingSubdrafts(primary);
    console.log(&quot;isect&quot;, isect);

      if(isect.length &#x3D;&#x3D; 0){
        return false;
      }   

      const bounds: Bounds &#x3D; utilInstance.getCombinedBounds(primary, isect);
      const temp: Draft &#x3D; this.getCombinedDraft(bounds, primary, isect);

      primary.setNewDraft(temp);
      primary.setComponentPosition(bounds.topleft);
      primary.drawDraft();

    //remove the intersecting drafts from the view containier and from subrefts
    isect.forEach(element &#x3D;&gt; {
      this.removeSubdraft(element.id);
    });
    return true;
  }

  computeHeddleValue(p:Point, main: SubdraftComponent, isect: Array&lt;SubdraftComponent&gt;):boolean{
    const a:boolean &#x3D; main.resolveToValue(p);
    //this may return an empty array, because the intersection might not have the point
    const b_array:Array&lt;SubdraftComponent&gt; &#x3D; isect.filter(el &#x3D;&gt; el.hasPoint(p));

    //should never have more than one value in barray
    // if(b_array.length &gt; 1) console.log(&quot;WARNING: Intersecting with Two Elements&quot;);

    const val:boolean &#x3D; b_array.reduce((acc:boolean, arr) &#x3D;&gt; arr.resolveToValue(p), null);   
    
    return utilInstance.computeFilter(main.ink, a, val);
  }



  getSubdraftsIntersectingSelection(selection: SelectionComponent){

    //find intersections between main and the others
    const drafts: Array&lt;SubdraftComponent&gt; &#x3D; this.tree.getDrafts();
    const isect:Array&lt;SubdraftComponent&gt; &#x3D; drafts.filter(sr &#x3D;&gt; (utilInstance.doOverlap(
      selection.bounds.topleft, 
      {x:  selection.bounds.topleft.x + selection.bounds.width, y: selection.bounds.topleft.y + selection.bounds.height}, 
      sr.getTopleft(), 
      {x: sr.getTopleft().x + sr.bounds.width, y: sr.getTopleft().y + sr.bounds.height}
      ) ? sr : null));

    return isect;
  
  }


 /**
   * get any subdrafts that intersect a given screen position
   * @param p the x, y position of this cell 
   * @returns 
   */
  getIntersectingSubdraftsForPoint(p: any){

    const primary_topleft &#x3D; {x:  p.x, y: p.y };
    const primary_bottomright &#x3D; {x:  p.x + this.scale, y: p.y + this.scale};

    const isect:Array&lt;SubdraftComponent&gt; &#x3D; [];
    const drafts: Array&lt;SubdraftComponent&gt; &#x3D; this.tree.getDrafts();
    drafts.forEach(sr &#x3D;&gt; {
      let sr_bottomright &#x3D; {x: sr.getTopleft().x + sr.bounds.width, y: sr.getTopleft().y + sr.bounds.height};
      const b: boolean &#x3D; utilInstance.doOverlap(primary_topleft, primary_bottomright, sr.getTopleft(), sr_bottomright);
      if(b) isect.push(sr);
     });

    return isect;
  }

  /**
   * get any subdrafts that intersect primary based on checks on their boundaries
   * @param primary 
   * @returns 
   */
  getIntersectingSubdrafts(primary: SubdraftComponent){

    const drafts:Array&lt;SubdraftComponent&gt; &#x3D; this.tree.getDrafts(); 
    const to_check:Array&lt;SubdraftComponent&gt; &#x3D;  drafts.filter(sr &#x3D;&gt; (sr.draft.id.toString() !&#x3D;&#x3D; primary.draft.id.toString()));
    const primary_bottomright &#x3D; {x:  primary.getTopleft().x + primary.bounds.width, y: primary.getTopleft().y + primary.bounds.height};


     const isect:Array&lt;SubdraftComponent&gt; &#x3D; [];
     to_check.forEach(sr &#x3D;&gt; {
      let sr_bottomright &#x3D; {x: sr.getTopleft().x + sr.bounds.width, y: sr.getTopleft().y + sr.bounds.height};
      const b: boolean &#x3D; utilInstance.doOverlap(primary.getTopleft(), primary_bottomright, sr.getTopleft(), sr_bottomright);
      if(b) isect.push(sr);
     });

    return isect;
  }

  getSelectionBounds(c1: any, c2: any): Bounds{
      let bottomright &#x3D; {x: 0, y:0};
      let bounds:Bounds &#x3D; {
        topleft:{x: 0, y:0},
        width: 0,
        height: 0
      }
      if(c1.i &lt; c2.i){
        bounds.topleft.y &#x3D; c1.i * this.scale;
        bottomright.y &#x3D; c2.i * this.scale;
      }else{
        bounds.topleft.y &#x3D; c2.i * this.scale;
        bottomright.y &#x3D; c1.i * this.scale;
      }

      if(c1.j &lt; c2.j){
        bounds.topleft.x &#x3D; c1.j * this.scale;
        bottomright.x &#x3D; c2.j * this.scale;
      }else{
        bounds.topleft.x &#x3D; c1.j * this.scale;
        bottomright.x &#x3D; c2.j * this.scale;
      }

      bounds.width &#x3D; bottomright.x - bounds.topleft.x;
      bounds.height &#x3D; bottomright.y - bounds.topleft.y;

      return bounds;
  }

      /**
     * creates a draft in size bounds that contains all of the computed points of its intersections
     * @param bounds the boundary of all the intersections
     * @param primary the primary draft that we are checking for intersections
     * @param isect an Array of the intersecting components
     * @returns 
     */
       getCombinedDraft(bounds: Bounds, primary: SubdraftComponent, isect: Array&lt;SubdraftComponent&gt;):Draft{
  
        const temp: Draft &#x3D; new Draft({id: primary.draft.id, name: primary.draft.name, warps: Math.floor(bounds.width / primary.scale), wefts: Math.floor(bounds.height / primary.scale)});
    
        for(var i &#x3D; 0; i &lt; temp.wefts; i++){
          const top: number &#x3D; bounds.topleft.y + (i * primary.scale);
          for(var j &#x3D; 0; j &lt; temp.warps; j++){
            const left: number &#x3D; bounds.topleft.x + (j * primary.scale);
    
            const p &#x3D; {x: left, y: top};
            const val &#x3D; this.computeHeddleValue(p, primary, isect);
            if(val !&#x3D; null) temp.pattern[i][j].setHeddle(val);
            else temp.pattern[i][j].unsetHeddle();
          }
        }
        return temp;
      }

}</code></pre>
        </div>
    </div>










                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
           </div>
       </div>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/search/search.js"></script>
       <script src="../js/search/lunr.min.js"></script>
       <script src="../js/search/search-lunr.js"></script>

       <script src="../js/menu.js"></script>
       <script src="../js/libs/highlight.pack.js"></script>
       <script src="../js/libs/highlightjs-line-numbers.min.js"></script>
       <script src="../js/search/search_index.js"></script>
       <script>
            document.addEventListener('DOMContentLoaded', function() {
                hljs.initHighlightingOnLoad();
                hljs.initLineNumbersOnLoad();
            });
       </script>

    </body>
</html>
